classdef TestModelPredictions < matlab.unittest.TestCase
    %This testcase is taken from Colquhoun,Hawkes, Srod. 1996 
    properties
        model
        params
        datafile
        qm
        kA
        kF
        tres
        conc
        t
        resolvedIntervals
        dcpoptions
    end    
    
    methods (TestClassSetup)
        function createExperiment(testCase)
            
            testCase.model = FiveState_9Param_QET();
            testCase.params=[50,3000,500,15000,2000,15,50,2000,5]'; %from paper 
            testCase.conc = 1;
            testCase.qm = testCase.model.generateQ(testCase.params,testCase.conc);
            testCase.kA = 2;
            testCase.kF = 3;
            testCase.tres = 5e-5;
            testCase.datafile = strcat(getenv('P_HOME'),'/BayesianInference/UnitTests/TestData/80000_tp6e6b5301_e3ed_4900_bbb4_746a1feecd5e_Synth_Ach_1.scn');
            testCase.t = [0.0000100000000000,0.0000101665330610,0.0000103358394490,0.0000105079653480,0.0000106829577110,0.0000108608642770,0.0000110417335750,0.0000112256149440,0.0000114125585460,0.0000116026153780,0.0000117958372840,0.0000119922769730,0.0000121919880330,0.0000123950249420,0.0000126014430870,0.0000128112987770,0.0000130246492580,0.0000132415527290,0.0000134620683610,0.0000136862563060,0.0000139141777230,0.0000141458947840,0.0000143814707010,0.0000146209697350,0.0000148644572200,0.0000151119995770,0.0000153636643320,0.0000156195201380,0.0000158796367890,0.0000161440852410,0.0000164129376350,0.0000166862673110,0.0000169641488290,0.0000172466579920,0.0000175338718680,0.0000178258688040,0.0000181227284550,0.0000184245318000,0.0000187313611680,0.0000190433002600,0.0000193604341700,0.0000196828494070,0.0000200106339240,0.0000203438771370,0.0000206826699510,0.0000210271047860,0.0000213772755990,0.0000217332779140,0.0000220952088450,0.0000224631671220,0.0000228372531210,0.0000232175688890,0.0000236042181710,0.0000239973064430,0.0000243969409340,0.0000248032306600,0.0000252162864540,0.0000256362209920,0.0000260631488280,0.0000264971864250,0.0000269384521820,0.0000273870664740,0.0000278431516760,0.0000283068322050,0.0000287782345480,0.0000292574872980,0.0000297447211910,0.0000302400691390,0.0000307436662680,0.0000312556499550,0.0000317761598620,0.0000323053379810,0.0000328433286640,0.0000333902786710,0.0000339463372040,0.0000345116559500,0.0000350863891220,0.0000356706935020,0.0000362647284810,0.0000368686561070,0.0000374826411240,0.0000381068510220,0.0000387414560780,0.0000393866294070,0.0000400425470040,0.0000407093877980,0.0000413873336960,0.0000420765696350,0.0000427772836300,0.0000434896668310,0.0000442139135670,0.0000449502214050,0.0000456987912030,0.0000464598271640,0.0000472335368890,0.0000480201314390,0.0000488198253890,0.0000496328368870,0.0000504593877150,0.0000512997033460,0.0000521540130110,0.0000530225497570,0.0000539055505100,0.0000548032561460,0.0000557159115480,0.0000566437656800,0.0000575870716510,0.0000585460867860,0.0000595210726920,0.0000605122953380,0.0000615200251180,0.0000625445369300,0.0000635861102510,0.0000646450292120,0.0000657215826740,0.0000668160643110,0.0000679287726850,0.0000690600113330,0.0000702100888440,0.0000713793189480,0.0000725680205990,0.0000737765180620,0.0000750051410040,0.0000762542245790,0.0000775241095260,0.0000788151422560,0.0000801276749480,0.0000814620656500,0.0000828186783690,0.0000841978831740,0.0000856000562990,0.0000870255802430,0.0000884748438730,0.0000899482425340,0.0000914461781540,0.0000929690593550,0.0000945173015620,0.0000960913271210,0.0000976915654100,0.0000993184529560,0.0001009724335590,0.0001026539584070,0.0001043634862040,0.0001061014832900,0.0001078684237730,0.0001096647896580,0.0001114910709730,0.0001133477659110,0.0001152353809570,0.0001171544310350,0.0001191054396410,0.0001210889389910,0.0001231054701630,0.0001251555832460,0.0001272398374890,0.0001293588014570,0.0001315130531800,0.0001337031803170,0.0001359297803110,0.0001381934605570,0.0001404948385630,0.0001428345421210,0.0001452132094790,0.0001476314895130,0.0001500900419040,0.0001525895373220,0.0001551306576010,0.0001577140959350,0.0001603405570580,0.0001630107574420,0.0001657254254900,0.0001684853017370,0.0001712911390480,0.0001741437028260,0.0001770437712230,0.0001799921353460,0.0001829895994800,0.0001860369813010,0.0001891351121050,0.0001922848370300,0.0001954870152880,0.0001987425204010,0.0002020522404370,0.0002054170782540,0.0002088379517460,0.0002123157940910,0.0002158515540090,0.0002194461960200,0.0002231007007050,0.0002268160649750,0.0002305933023430,0.0002344334432020,0.0002383375351020,0.0002423066430400,0.0002463418497480,0.0002504442559880,0.0002546149808550,0.0002588551620800,0.0002631659563420,0.0002675485395800,0.0002720041073180,0.0002765338749900,0.0002811390782690,0.0002858209734090,0.0002905808375820,0.0002954199692300,0.0003003396884190,0.0003053413371980,0.0003104262799650,0.0003155959038410,0.0003208516190450,0.0003261948592840,0.0003316270821390,0.0003371497694640,0.0003427644277910,0.0003484725887430,0.0003542758094460,0.0003601756729610,0.0003661737887090,0.0003722717929140,0.0003784713490510,0.0003847741482940,0.0003911819099820,0.0003976963820870,0.0004043193416910,0.0004110525954680,0.0004178979801820,0.0004248573631840,0.0004319326429210,0.0004391257494570,0.0004464386449990,0.0004538733244290,0.0004614318158520,0.0004691161811470,0.0004769285165290,0.0004848709531240,0.0004929456575470,0.0005011548324950,0.0005095007173460,0.0005179855887730,0.0005266117613620,0.0005353815882430,0.0005442974617370,0.0005533618140010,0.0005625771176990,0.0005719458866700,0.0005814706766190,0.0005911540858110,0.0006009987557810,0.0006110073720540,0.0006211826648770,0.0006315274099670,0.0006420444292640,0.0006527365917040,0.0006636068139970,0.0006746580614310,0.0006858933486710,0.0006973157405890,0.0007089283530970,0.0007207343539960,0.0007327369638420,0.0007449394568250,0.0007573451616590,0.0007699574624930,0.0007827797998350,0.0007958156714850,0.0008090686334980,0.0008225423011440,0.0008362403499020,0.0008501665164590,0.0008643245997320,0.0008787184619000,0.0008933520294610,0.0009082292943030,0.0009233543147910,0.0009387312168760,0.0009543641952180,0.0009702575143350,0.0009864155097610,0.0010028425892310,0.0010195432338840,0.0010365219994860,0.0010537835176700,0.0010713324972000,0.0010891737252590,0.0011073120687510,0.0011257524756300,0.0011444999762500,0.0011635596847370,0.0011829368003850,0.0012026366090720,0.0012226644847040,0.0012430258906800,0.0012637263813840,0.0012847716036970,0.0013061672985390,0.0013279193024380,0.0013500335491180,0.0013725160711170,0.0013953730014380,0.0014186105752180,0.0014422351314270,0.0014662531146040,0.0014906710766080,0.0015154956784080,0.0015407336919020,0.0015663920017610,0.0015924776073090,0.0016189976244330,0.0016459592875200,0.0016733699514380,0.0017012370935330,0.0017295683156760,0.0017583713463360,0.0017876540426830,0.0018174243927370,0.0018476905175450,0.0018784606733950,0.0019097432540700,0.0019415467931380,0.0019738799662790,0.0020067515936510,0.0020401706422970,0.0020741462285910,0.0021086876207250,0.0021438042412370,0.0021795056695820,0.0022158016447420,0.0022527020678880,0.0022902170050780,0.0023283566900020,0.0023671315267750,0.0024065520927760,0.0024466291415310,0.0024873736056480,0.0025287965998000,0.0025709094237550,0.0026137235654600,0.0026572507041730,0.0027015027136540,0.0027464916653960,0.0027922298319240,0.0028387296901430,0.0028860039247350,0.0029340654316300,0.0029829273215120,0.0030326029234050,0.0030831057883050,0.0031344496928750,0.0031866486432060,0.0032397168786380,0.0032936688756410,0.0033485193517670,0.0034042832696640,0.0034609758411580,0.0035186125314010,0.0035772090630920,0.0036367814207650,0.0036973458551470,0.0037589188875970,0.0038215173146060,0.0038851582123840,0.0039498589415170,0.0040156371516990,0.0040825107865540,0.0041504980885220,0.0042196176038440,0.0042898881876160,0.0043613290089320,0.0044339595561170,0.0045077996420390,0.0045828694095180,0.0046591893368170,0.0047367802432310,0.0048156632947630,0.0048958600099010,0.0049773922654890,0.0050602823026900,0.0051445527330570,0.0052302265446990,0.0053173271085560,0.0054058781847670,0.0054959039291610,0.0055874288998360,0.0056804780638690,0.0057750768041160,0.0058712509261460,0.0059690266652730,0.0060684306937170,0.0061694901278790,0.0062722325357370,0.0063766859443670,0.0064828788475890,0.0065908402137380,0.0067005994935700,0.0068121866282920,0.0069256320577290,0.0070409667286340,0.0071582221031220,0.0072774301672590,0.0073986234397830,0.0075218349809770,0.0076470984016880,0.0077744478724920,0.0079039181330200,0.0080355445014340,0.0081693628840580,0.0083054097851760,0.0084437223169880,0.0085843382097350,0.0087272958219940,0.0088726341511360,0.0090203928439670,0.0091706122075450,0.0093233332201740,0.0094785975425810,0.0096364475292830,0.0097969262401380,0.0099600774520950,0.0101259456711320,0.0102945761444010,0.0104660148725660,0.0106403086223570,0.0108175049393220,0.0109976521608010,0.0111807994291110,0.0113669967049490,0.0115562947810250,0.0117487452959150,0.0119444007481470,0.0121433145105250,0.0123455408446830,0.0125511349158950,0.0127601528081160,0.0129726515392860,0.0131886890768820,0.0134083243537300,0.0136316172840840,0.0138586287799660,0.0140894207677890,0.0143240562052400,0.0145625990984640,0.0148051145195170,0.0150516686241210,0.0153023286697120,0.0155571630337790,0.0158162412325280,0.0160796339398360,0.0163474130065350,0.0166196514800110,0.0168964236241300,0.0171778049394980,0.0174638721840540,0.0177547033940120,0.0180503779051450,0.0183509763744320,0.0186565808020550,0.0189672745537700,0.0192831423836490,0.0196042704572010,0.0199307463748740,0.0202626591959520,0.0206000994628530,0.0209431592258250,0.0212919320680560,0.0216465131312030,0.0220069991413480,0.0223734884353810,0.0227460809878260,0.0231248784381150,0.0235099841183100,0.0239015030812950,0.0242995421294330,0.0247042098436970,0.0251156166132940,0.0255338746657740,0.0259590980976510,0.0263914029055180,0.0268309070176990,0.0272777303264120,0.0277319947204780,0.0281938241185680,0.0286633445030120,0.0291406839541600,0.0296259726853220,0.0301193430782930,0.0306209297194610,0.0311308694365230,0.0316493013358080,0.0321763668402280,0.0327122097278510,0.0332569761711280,0.0338108147767610,0.0343738766262490,0.0349463153170960,0.0355282870047100,0.0361199504450060,0.0367214670377070,0.0373330008703790,0.0379547187631840,0.0385867903143930,0.0392293879466500,0.0398826869540060,0.0405468655497350,0.0412221049149530,0.0419085892480420,0.0426065058148930,0.0433160449999960,0.0440374003583700,0.0447707686683670,0.0455163499853470,0.0462743476962540];

            testCase.dcpoptions{1} = 2;
            testCase.dcpoptions{2} = 1e-12;
            testCase.dcpoptions{3} = 1e-12;
            testCase.dcpoptions{4} = 100;
            testCase.dcpoptions{5} = -1e6;
            testCase.dcpoptions{6} = 0;
            
            [~,data]=DataController.read_scn_file(testCase.datafile);
            data.intervals=data.intervals/1000;
            testCase.resolvedIntervals = RecordingManipulator.imposeResolution(data,testCase.tres);
        
        end
    end    
    
    methods(Test)
        function testUnconditionalExactOpenPdf(testCase)
            unconditional_exact_open_pdf = UnconditionalExactPDF(testCase.qm,testCase.kA,testCase.kF,testCase.tres,testCase.t,1,testCase.dcpoptions);
            result = [0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0293877510793781,0.0298258167294961,0.0302696429323440,0.0307192822456158,0.0311747869805767,0.0316362091767334,0.0321036005679111,0.0325770125557088,0.0330564961764069,0.0335421020700531,0.0340338804455921,0.0345318810516377,0.0350361531372151,0.0355467454191308,0.0360637060458447,0.0365870825598831,0.0371169218592950,0.0376532701610845,0.0381961729592269,0.0387456749871004,0.0393018201735559,0.0398646516033665,0.0404342114732928,0.0410105410486412,0.0415936806202856,0.0421836694574092,0.0427805457650107,0.0433843466348072,0.0439951079990432,0.0446128645852583,0.0452376498646352,0.0458694960051336,0.0465084338233482,0.0471544927337985,0.0478077006984721,0.0484680841784361,0.0491356680821422,0.0498104757154640,0.0504925287299407,0.0511818470741667,0.0518784489413286,0.0525823507187385,0.0532936031389413,0.0540119287164236,0.0547373874858972,0.0554699747323894,0.0562096831897367,0.0569565029821414,0.0577104215644821,0.0584714236693673,0.0592394912482106,0.0600146034209036,0.0607967364202796,0.0615858635433552,0.0623819551009781,0.0631849783712952,0.0639948975544031,0.0648116737310990,0.0656352648204851,0.0664656255451356,0.0673027073947631,0.0681464585970132,0.0689968240880097,0.0698537454892859,0.0707171610879107,0.0715870058197242,0.0724632112577591,0.0733457056067467,0.0742344136982937,0.0751292569976071,0.0760301536089761,0.0769370182922185,0.0778497624823139,0.0787682943169993,0.0796925186688858,0.0806223371867436,0.0815576483438344,0.0824983474910471,0.0834443269222323,0.0843954759433162,0.0853516809537880,0.0863128255335675,0.0872787905408927,0.0882494542195767,0.0892246923147308,0.0902043781996333,0.0911883830121889,0.0921765758012825,0.0931688236855509,0.0941649920219079,0.0951649445849588,0.0961685437588830,0.0971756507405586,0.0981861257549167,0.0991998282808343,0.1002166172913911,0.1012363515046255,0.1022588896472590,0.1032840907316282,0.1043118143438441,0.1053419209454177,0.1063742721861031,0.1074087312309899,0.1084451630985800,0.1094834350106985,0.1105234167560405,0.1115649810630068,0.1126080039860357,0.1136523653021130,0.1146979489177454,0.1157446432863436,0.1167923418356535,0.1178409434032002,0.1188903526819187,0.1199404806713958,0.1209912451373516,0.1220425710770365,0.1230943911899699,0.1241466463513425,0.1251992860908527,0.1262522690708208,0.1273055635668780,0.1283591479474760,0.1294130111500026,0.1304671531550673,0.1315215854545962,0.1325763315132691,0.1336314272208986,0.1346869213356448,0.1357428759134519,0.1367993667237989,0.1378564836496337,0.1389143310682913,0.1399730282113945,0.1410327095029031,0.1420935248710978,0.1431556400332945,0.1442192367511063,0.1452845130524311,0.1463516834193136,0.1474209789379479,0.1484926474094716,0.1495669534175930,0.1506441783516985,0.1517246203832553,0.1528085943908291,0.1538964318346972,0.1549884805751497,0.1560851046352797,0.1571866839036455,0.1582936137761986,0.1594063047347470,0.1605251818602873,0.1616506842798828,0.1627832645442860,0.1639233879365370,0.1650715317086824,0.1662281842478477,0.1673938441675913,0.1685690193278070,0.1697542257799435,0.1709499866389151,0.1721568308820835,0.1733752920754951,0.1746059070281019,0.1758492143762158,0.1771057530989820,0.1783760609664412,0.1796606729245459,0.1809601194165847,0.1822749246476758,0.1836056047929386,0.1849526661548978,0.1863166032730560,0.1876978969916245,0.1890970124892807,0.1905143972764283,0.1919504791661420,0.1934056642239985,0.1948803347041703,0.1963748469767523,0.1978895294548087,0.1994246805273545,0.2009805665057167,0.2025574195904401,0.2041554358669514,0.2057747733376564,0.2074155499972924,0.2090778419604765,0.2107616816486241,0.2124670560439804,0.2141939050184677,0.2159421197443447,0.2177115411945242,0.2195019587387756,0.2213131088428811,0.2231446738762864,0.2249962810348666,0.2268675013838007,0.2287578490246260,0.2306667803916316,0.2325936936814401,0.2345379284174778,0.2364987651526921,0.2384754253127137,0.2404670711785667,0.2424728060111358,0.2444916743160272,0.2465226622472567,0.2485646981486778,0.2506166532299578,0.2526773423734918,0.2547455250694907,0.2568199064723881,0.2588991385758511,0.2609818214986885,0.2630665048756280,0.2651516893472983,0.2672358281409051,0.2693173287347672,0.2713945545991555,0.2734658270052565,0.2755294268943483,0.2775835967993461,0.2796265428109406,0.2816564365804716,0.2836714173521813,0.2856695940177017,0.2876490471861476,0.2896078312633331,0.2915439765351081,0.2934554912488191,0.2953403636890703,0.2971965642440774,0.2990220474595101,0.3008147540775279,0.3025726130599644,0.3042935435948403,0.3059754570863601,0.3076162591296605,0.3092138514718019,0.3107661339618949,0.3122710064928355,0.3137263709394824,0.3151301330969495,0.3164802046239919,0.3177745049975607,0.3190109634830796,0.3201875211277072,0.3213021327817784,0.3223527691551602,0.3233374189147967,0.3242540908294401,0.3251008159675570,0.3258756499542729,0.3265766752924881,0.3272020037531266,0.3277497788388126,0.3282181783247755,0.3286054168799628,0.3289097487707412,0.3291294706487856,0.3292629244237769,0.3293085002209160,0.3292646394221556,0.3291298377892885,0.3289026486660376,0.3285816862554373,0.3281656289677685,0.3276532228335557,0.3270432849751073,0.3263347071292056,0.3255264592128496,0.3246175929228752,0.3236072453597833,0.3224946426650401,0.3212791036606845,0.3199600434790837,0.3185369771703034,0.3170095232739322,0.3153774073413121,0.3136404653940986,0.3117986473041326,0.3098520200797645,0.3078007710424410,0.3056452108784122,0.3033857765484376,0.3010230340400210,0.2985576809445655,0.2959905488436100,0.2933226054866250,0.2905549567439679,0.2876888483181162,0.2847256671964871,0.2816669428294515,0.2785143480174321,0.2752696994910252,0.2719349581691234,0.2685122290798377,0.2650037609297966,0.2614119453088650,0.2577393155165977,0.2539885449992603,0.2501624453859320,0.2462639641140817,0.2422961816360252,0.2382623081984938,0.2341656801897609,0.2300097560497795,0.2257981117401713,0.2215344357732812,0.2172225238006848,0.2128662727637630,0.2084696746111796,0.2040368095893518,0.1995718391149771,0.1950789982406483,0.1905625877267051,0.1860269657347745,0.1814765391611777,0.1769157546301554,0.1723490891699936,0.1677810405966613,0.1632161176328524,0.1586588297916260,0.1541136770572160,0.1495851393966424,0.1450776661387864,0.1405956652590876,0.1361434926097673,0.1317254411377172,0.1273457301331495,0.1230084945536462,0.1187177744696507,0.1144775046775807,0.1102915045284964,0.1061634680194009,0.1020969541953479,0.0980953779097446,0.0941620009898533,0.0902999238538813,0.0865120776243869,0.0828012167820074,0.0791699124005877,0.0756205460038253,0.0721553040799637,0.0687761732888967,0.0654849363927203,0.0622831689368183,0.0591722367057051,0.0561532939727955,0.0532272825596809,0.0503949317156016,0.0476567588231377,0.0450130709313254,0.0424639671121997,0.0400093416318770,0.0376488879218612,0.0353821033313883,0.0332082946361793,0.0311265842741655,0.0291359172737490,0.0272350688354824,0.0254226525234865,0.0236971290187791,0.0220568153828404,0.0204998947761165,0.0190244265731242,0.0176283568131391,0.0163095289232971,0.0150656946492006,0.0138945251270292,0.0127936220305758,0.0117605287265396,0.0107927413720379,0.0098877198893726,0.0090428987547525,0.0082556975399736,0.0075235311487481,0.0068438196927378,0.0062139979559747,0.0056315244006535,0.0050938896717341,0.0045986245627629,0.0041433074104521,0.0037255708910003,0.0033431081966534,0.0029936785766944,0.0026751122327350,0.0023853145638242,0.0021222697624585,0.0018840437679659,0.0016687865889195,0.0014747340111163,0.0013002087122406,0.0011436208084992,0.0010034678623078,0.0008783343834044,0.0007668908586169,0.0006678923478503,0.0005801766856820,0.0005026623292735,0.0004343458941030,0.0003742994193303,0.0003216674044190,0.0002756636580047,0.0002355679989286,0.0002007228479003,0.0001705297464442,0.0001444458376652,0.0001219803409996,0.0001026910505259,0.0000861808836642,0.0000720945042318];
            testCase.verifyEqual(unconditional_exact_open_pdf',result,'AbsTol', 1e-10);
        end
        
        function testUnconditionalExactShutPdf(testCase)
            unconditional_exact_shut_pdf = UnconditionalExactPDF(testCase.qm,testCase.kA,testCase.kF,testCase.tres,testCase.t,0,testCase.dcpoptions);
            result =[0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.4839241314310213,0.4842074704594789,0.4843654296737193,0.4843959438266907,0.4842970226061078,0.4840667559703868,0.4837033195576412,0.4832049801543331,0.4825701012177954,0.4817971484374782,0.4808846953296261,0.4798314288370016,0.4786361549477672,0.4772978042900957,0.4758154377046886,0.4741882517776994,0.4724155843169650,0.4704969197437477,0.4684318944066314,0.4662203017656902,0.4638620974665343,0.4613574042439295,0.4587065166686883,0.4559099056980248,0.4529682230063674,0.4498823050985497,0.4466531771381065,0.4432820565258827,0.4397703561581411,0.4361196873488254,0.4323318624370159,0.4284088969927109,0.4243530116318089,0.4201666334275260,0.4158523968796354,0.4114131444073150,0.4068519263801609,0.4021720006348065,0.3973768314818408,0.3924700881509912,0.3874556427068452,0.3823375673794540,0.3771379084781922,0.3718013156227468,0.3663543725421275,0.3608012485584514,0.3551463067650023,0.3493940996431509,0.3435493640739575,0.3376170156763210,0.3316021425659003,0.3255099984203037,0.3193459949590845,0.3131156937486909,0.3068247974046154,0.3004791401578623,0.2940846778192456,0.2876474771344875,0.2811737045907786,0.2746696146287491,0.2681415373573389,0.2615958657332930,0.2550390422961046,0.2484775454430610,0.2419178753094533,0.2353665392977328,0.2288300372863770,0.2223148465621435,0.2158274065688921,0.2093741034484796,0.2029612545268671,0.1965950927173333,0.1902817509613184,0.1840272467383410,0.1778374667364807,0.1717181517202895,0.1656748816814223,0.1597130613565825,0.1538379061357901,0.1480544284862398,0.1423674249073917,0.1367814635302071,0.1313008723932900,0.1259297284723816,0.1206718475310862,0.1155307748378250,0.1105097768145745,0.1056118336678352,0.1008396330373274,0.0961955647195096,0.0916817164973530,0.0872998711012208,0.0830515043327835,0.0789377843668645,0.0749595722505793,0.0711174235894402,0.0674115914345052,0.0638420303509326,0.0604084016508264,0.0571100797728258,0.0539461597684198,0.0509154658628806,0.0480165610345686,0.0452477575690270,0.0426071285239931,0.0400925200339323,0.0377015643924662,0.0354316938235098,0.0332801548664857,0.0312440232870818,0.0293202194227340,0.0275055238700431,0.0257965934219864,0.0241899771540889,0.0226821325698068,0.0212694417034186,0.0199482270884453,0.0187147674985426,0.0175653133730601,0.0164961018366994,0.0155033712374877,0.0145833751214404,0.0137323955760520,0.0129467558785640,0.0122228323889680,0.0115570656399770,0.0109459705803647,0.0103861459374962,0.0098742826716374,0.0094071715053087,0.0089817095163744,0.0085949057931092,0.0082438861576288,0.0079258969710314,0.0076383080406137,0.0073786146574168,0.0071444387975848,0.0069335295271576,0.0067437626552823,0.0065731396845609,0.0064197861115771,0.0062819491331414,0.0061579948164343,0.0060464047922890,0.0059457725317986,0.0058547992666688,0.0057722896125360,0.0056971469538632,0.0056283686465464,0.0055650410924234,0.0055063347366870,0.0054514990360940,0.0053998574421698,0.0053508024397253,0.0053037906769993,0.0052583382194029,0.0052140159547414,0.0051704451733776,0.0051272933428478,0.0050842700921192,0.0050411234170670,0.0049976361149306,0.0049536224521616,0.0049089250669757,0.0048634121051068,0.0048169745847178,0.0047695239843277,0.0047209900457532,0.0046713187824517,0.0046204706826437,0.0045684190954120,0.0045151487875890,0.0044606546586749,0.0044049406009989,0.0043480184922707,0.0042899073079993,0.0042306323415817,0.0041702245203475,0.0041087198064989,0.0040461586724828,0.0039825856411675,0.0039180488818224,0.0038525998537733,0.0037862929903381,0.0037191854164251,0.0036513366938695,0.0035828085893126,0.0035136648601298,0.0034439710544361,0.0033737943218499,0.0033032032321830,0.0032322675997005,0.0031610583110425,0.0030896471552361,0.0030181066546217,0.0029465098957702,0.0028749303597740,0.0028034417514668,0.0027321178273701,0.0026610322223539,0.0025902582750779,0.0025198688524418,0.0024499361734314,0.0023805316327529,0.0023117256247468,0.0022435873682164,0.0021761847327279,0.0021095840670769,0.0020438500306348,0.0019790454282699,0.0019152310496027,0.0018524655133549,0.0017908051175082,0.0017303036960895,0.0016710124832477,0.0016129799854025,0.0015562518621582,0.0015008708166247,0.0014468764958232,0.0013943054017601,0.0013431908137159,0.0012935627222636,0.0012454477754594,0.0011988692375902,0.0011538469607944,0.0011103973698109,0.0010685334600302,0.0010282648089488,0.0009895976010436,0.0009525346660129,0.0009170755302239,0.0008832164811586,0.0008509506445338,0.0008202680737006,0.0007911558508499,0.0007635981994682,0.0007375766074066,0.0007130699598593,0.0006900546814794,0.0006685048867898,0.0006483925380001,0.0006296876092767,0.0006123582564904,0.0005963709914012,0.0005816908592409,0.0005682816186222,0.0005561059226849,0.0005451255004147,0.0005353013370459,0.0005265938525080,0.0005189630768818,0.0005123688218765,0.0005067708473827,0.0005021290222081,0.0004984034781623,0.0004955547567275,0.0004935439476232,0.0004923328186534,0.0004918839363089,0.0004921607766839,0.0004931278263565,0.0004947506729766,0.0004969960853920,0.0004998320832416,0.0005032279960282,0.0005071545117774,0.0005115837154672,0.0005164891174967,0.0005218456725346,0.0005276297891558,0.0005338193307373,0.0005403936081366,0.0005473333647246,0.0005546207543799,0.0005622393130838,0.0005701739247758,0.0005784107821426,0.0005869373430183,0.0005957422830724,0.0006048154454488,0.0006141477880053,0.0006237313287774,0.0006335590902628,0.0006436250430842,0.0006539240495585,0.0006644518076472,0.0006752047957297,0.0006861802185835,0.0006973759549207,0.0007087905067682,0.0007204229509446,0.0007322728928328,0.0007443404226036,0.0007566260740069,0.0007691307858036,0.0007818558658749,0.0007948029580155,0.0008079740113811,0.0008213712525409,0.0008349971600589,0.0008488544415076,0.0008629460128073,0.0008772749797660,0.0008918446216899,0.0009066583769266,0.0009217198302014,0.0009370327016034,0.0009526008370838,0.0009684282003262,0.0009845188658592,0.0010008770132841,0.0010175069224975,0.0010344129697979,0.0010515996247713,0.0010690714478616,0.0010868330885387,0.0011048892839838,0.0011232448582239,0.0011419047216504,0.0011608738708679,0.0011801573888234,0.0011997604451741,0.0012196882968576,0.0012399462888316,0.0012605398549594,0.0012814745190150,0.0013027558957922,0.0013243896923005,0.0013463817090348,0.0013687378413093,0.0013914640806462,0.0014145665162127,0.0014380513363010,0.0014619248298462,0.0014861933879814,0.0015108635056225,0.0015359417830865,0.0015614349277377,0.0015873497556625,0.0016136931933724,0.0016404722795332,0.0016676941667228,0.0016953661232137,0.0017234955347841,0.0017520899065553,0.0017811568648560,0.0018107041591146,0.0018407396637774,0.0018712713802568,0.0019023074389058,0.0019338561010216,0.0019659257608775,0.0019985249477840,0.0020316623281791,0.0020653467077481,0.0020995870335728,0.0021343923963120,0.0021697720324116,0.0022057353263454,0.0022422918128877,0.0022794511794170,0.0023172232682516,0.0023556180790169,0.0023946457710451,0.0024343166658085,0.0024746412493845,0.0025156301749546,0.0025572942653368,0.0025996445155521,0.0026426920954250,0.0026864483522182,0.0027309248133026,0.0027761331888618,0.0028220853746322,0.0028687934546790,0.0029162697042067,0.0029645265924074,0.0030135767853440,0.0030634331488716,0.0031141087515933,0.0031656168678555,0.0032179709807790,0.0032711847853277,0.0033252721914155,0.0033802473270510,0.0034361245415191,0.0034929184086022,0.0035506437298390,0.0036093155378223,0.0036689490995342,0.0037295599197216,0.0037911637443094,0.0038537765638528,0.0039174146170293,0.0039820943941680,0.0040478326408201,0.0041146463613667,0.0041825528226662,0.0042515695577413,0.0043217143695034,0.0043930053345181,0.0044654608068067,0.0045390994216888,0.0046139400996622,0.0046900020503210,0.0047673047763114,0.0048458680773272,0.0049257120541406,0.0050068571126713,0.0050893239680925,0.0051731336489732,0.0052583075014569,0.0053448671934753,0.0054328347189981];
            testCase.verifyEqual(unconditional_exact_shut_pdf',result,'AbsTol', 1e-10);
        end        

        function testUnconditionalIdealOpenPdf(testCase)
            unconditional_ideal_open_pdf = UnconditionalIdealPDF(testCase.qm,testCase.kA,testCase.kF,testCase.tres,testCase.t,1,testCase.dcpoptions);
            result=[0.0078396821736902,0.0079680913127504,0.0080985677395594,0.0082311435398182,0.0083658512573107,0.0085027239023219,0.0086417949498989,0.0087830983502700,0.0089266685337086,0.0090725404144619,0.0092207493945136,0.0093713313717698,0.0095243227449881,0.0096797604162227,0.0098376817992030,0.0099981248229141,0.0101611279365040,0.0103267301147421,0.0104949708655457,0.0106658902296479,0.0108395287930041,0.0110159276837054,0.0111951285846515,0.0113771737322566,0.0115621059263117,0.0117499685319675,0.0119408054844859,0.0121346612967356,0.0123315810603265,0.0125316104517516,0.0127347957397211,0.0129411837853687,0.0131508220474279,0.0133637585885735,0.0135800420806486,0.0137997218035113,0.0140228476548098,0.0142494701495884,0.0144796404270244,0.0147134102537489,0.0149508320260083,0.0151919587721554,0.0154368441599360,0.0156855424958410,0.0159381087292353,0.0161945984560041,0.0164550679187304,0.0167195740123273,0.0169881742839406,0.0172609269345585,0.0175378908230398,0.0178191254658714,0.0181046910378390,0.0183946483765365,0.0186890589781443,0.0189879850014462,0.0192914892682438,0.0195996352601801,0.0199124871215060,0.0202301096582044,0.0205525683334874,0.0208799292720744,0.0212122592520260,0.0215496257089563,0.0218920967292412,0.0222397410482602,0.0225926280485266,0.0229508277540696,0.0233144108275750,0.0236834485659051,0.0240580128925516,0.0244381763570769,0.0248240121228028,0.0252155939664612,0.0256129962667841,0.0260162939985288,0.0264255627240156,0.0268408785850147,0.0272623182914037,0.0276899591143834,0.0281238788721549,0.0285641559222182,0.0290108691460992,0.0294640979399095,0.0299239221973122,0.0303904222996394,0.0308636790976788,0.0313437738977356,0.0318307884435354,0.0323248049029948,0.0328259058445390,0.0333341742223927,0.0338496933562155,0.0343725469099293,0.0349028188683407,0.0354405935183774,0.0359859554232356,0.0365389893983453,0.0370997804870430,0.0376684139318540,0.0382449751508521,0.0388295497061824,0.0394222232742294,0.0400230816193562,0.0406322105564294,0.0412496959229042,0.0418756235423354,0.0425100791906687,0.0431531485573002,0.0438049172134373,0.0444654705672631,0.0451348938276676,0.0458132719633017,0.0465006896595967,0.0471972312743916,0.0479029807960105,0.0486180217940597,0.0493424373758522,0.0500763101342586,0.0508197221011110,0.0515727546945876,0.0523354886669850,0.0531080040528200,0.0538903801109549,0.0546826952726935,0.0554850270807567,0.0562974521317009,0.0571200460191857,0.0579528832682228,0.0587960372752723,0.0596495802460893,0.0605135831295375,0.0613881155510774,0.0622732457483131,0.0631690405013511,0.0640755650646479,0.0649928830955558,0.0659210565861358,0.0668601457887548,0.0678102091432447,0.0687713032061572,0.0697434825728179,0.0707267998050681,0.0717213053525269,0.0727270474789849,0.0737440721853044,0.0747724231289914,0.0758121415512209,0.0768632661938708,0.0779258332263332,0.0789998761631257,0.0800854257885686,0.0811825100769404,0.0822911541153970,0.0834113800258971,0.0845432068900156,0.0856866506692374,0.0868417241326326,0.0880084367791985,0.0891867947666797,0.0903768008364360,0.0915784542434246,0.0927917506866801,0.0940166822399697,0.0952532372853454,0.0965014004506832,0.0977611525433578,0.0990324704952193,0.1003153273005738,0.1016096919642350,0.1029155294484143,0.1042328006250087,0.1055614622281477,0.1069014668134209,0.1082527627205395,0.1096152940359336,0.1109890005657335,0.1123738178067285,0.1137696769275124,0.1151765047494247,0.1165942237352464,0.1180227519830265,0.1194620032234685,0.1209118868245747,0.1223723078010423,0.1238431668286126,0.1253243602669082,0.1268157801865932,0.1283173144023226,0.1298288465136477,0.1313502559518668,0.1328814180341306,0.1344222040220765,0.1359724811906366,0.1375321129010420,0.1391009586816461,0.1406788743168654,0.1422657119411316,0.1438613201412440,0.1454655440636420,0.1470782255312991,0.1486992031652377,0.1503283125120354,0.1519653861802703,0.1536102539792464,0.1552627430667925,0.1569226781011694,0.1585898813978045,0.1602641730911072,0.1619453713011843,0.1636332923026464,0.1653277506994931,0.1670285595992950,0.1687355307915130,0.1704484749269186,0.1721672016979466,0.1738915200164460,0.1756212381942640,0.1773561641175868,0.1790961054214961,0.1808408696597332,0.1825902644672277,0.1843440977192899,0.1861021776816479,0.1878643131520288,0.1896303135908467,0.1913999892424839,0.1931731512411924,0.1949496117035779,0.1967291838060123,0.1985116818435848,0.2002969212692804,0.2020847187141267,0.2038748919834180,0.2056672600292605,0.2074616428980939,0.2092578616491379,0.2110557382447668,0.2128550954090014,0.2146557564543644,0.2164575450729775,0.2182602850921929,0.2200638001936533,0.2218679135905051,0.2236724476669680,0.2254772235729248,0.2272820607773723,0.2290867765755171,0.2308911855509231,0.2326950989905321,0.2344983242520795,0.2363006640838927,0.2381019158945886,0.2399018709749881,0.2417003136694943,0.2434970205005594,0.2452917592413865,0.2470842879433950,0.2488743539146511,0.2506616926525320,0.2524460267321226,0.2542270646514135,0.2560044996350546,0.2577780084004661,0.2595472498877717,0.2613118639560759,0.2630714700523283,0.2648256658519844,0.2665740258805548,0.2683161001165789,0.2700514125832025,0.2717794599318651,0.2734997100254684,0.2752116005254886,0.2769145374895059,0.2786078939863366,0.2802910087346641,0.2819631847735893,0.2836236881706124,0.2852717467766097,0.2869065490346215,0.2885272428506757,0.2901329345345298,0.2917226878192819,0.2932955229681559,0.2948504159759463,0.2963862978747108,0.2979020541514696,0.2993965242862578,0.3008685014187732,0.3023167321512173,0.3037399164955937,0.3051367079722740,0.3065057138672783,0.3078454956543948,0.3091545695889746,0.3104314074787923,0.3116744376366150,0.3128820460196690,0.3140525775599585,0.3151843376877807,0.3162755940515916,0.3173245784361649,0.3183294888789114,0.3192884919855737,0.3201997254440215,0.3210613007344093,0.3218713060336429,0.3226278093105371,0.3233288616073954,0.3239725005033763,0.3245567537529493,0.3250796430935425,0.3255391882141443,0.3259334108766758,0.3262603391812529,0.3265180119651799,0.3267044833253704,0.3268178272530761,0.3268561423692067,0.3268175567480823,0.3267002328170046,0.3265023723186067,0.3262222213226256,0.3258580752734707,0.3254082840597506,0.3248712570917490,0.3242454683728259,0.3235294615504134,0.3227218549327225,0.3218213464569531,0.3208267185949817,0.3197368431827249,0.3185506861595769,0.3172673122042358,0.3158858892537400,0.3144056928927302,0.3128261105999134,0.3111466458393698,0.3093669219839800,0.3074866860596362,0.3055058122973033,0.3034243054820179,0.3012423040874686,0.2989600831837850,0.2965780571092415,0.2940967818929021,0.2915169574190253,0.2888394293218184,0.2860651905998693,0.2831953829401769,0.2802312977415607,0.2771743768267433,0.2740262128336362,0.2707885492757364,0.2674632802621848,0.2640524498677945,0.2605582511443946,0.2569830247647109,0.2533292572899491,0.2495995790546073,0.2457967616599309,0.2419237150706718,0.2379834843093204,0.2339792457422825,0.2299143029559731,0.2257920822182724,0.2216161275259680,0.2173900952371822,0.2131177482904442,0.2088029500143973,0.2044496575321479,0.2000619147680727,0.1956438450650077,0.1911996434233894,0.1867335683745738,0.1822499335039882,0.1777530986416970,0.1732474607392863,0.1687374444559008,0.1642274924771126,0.1597220555942319,0.1552255825715539,0.1507425098346502,0.1462772510110069,0.1418341863606273,0.1374176521319882,0.1330319298844807,0.1286812358169416,0.1243697101455780,0.1201014065748646,0.1158802819062507,0.1117101858305563,0.1075948509505234,0.1035378830799497,0.0995427518666852,0.0956127817855907,0.0917511435473130,0.0879608459686765,0.0842447283475356,0.0806054533852377,0.0770455006964843,0.0735671609450235,0.0701725306407883,0.0668635076308014,0.0636417873136820,0.0605088596035747,0.0574660066653774,0.0545143014395796,0.0516546069702054,0.0488875765450634,0.0462136546529138,0.0436330787567442,0.0411458818779182,0.0387518959806913,0.0364507561414012,0.0342419054815492,0.0321246008391467,0.0300979191474470,0.0281607644857634,0.0263118757620804,0.0245498349832337,0.0228730760639373,0.0212798941226694,0.0197684552086364,0.0183368064014580,0.0169828862225482,0.0157045352951476,0.0144995071886436,0.0133654793816801,0.0123000642782274,0.0113008202110075,0.0103652623672015,0.0094908735729252,0.0086751148744997,0.0079154358571638,0.0072092846446283,0.0065541175262965,0.0059474081628468,0.0053866563250358,0.0048693961253261,0.0043932037067001,0.0039557043583994,0.0035545790335583,0.0031875702493294,0.0028524873556760,0.0025472111645692,0.0022696979369907,0.0020179827304755,0.0017901821152703,0.0015844962721718,0.0013992104898561,0.0012326960839041,0.0010834107637300,0.0009498984772125,0.0008307887659436,0.0007247956666745,0.0006307161966670,0.0005474284623211,0.0004738894315751,0.0004091324112096,0.0003522642703297,0.0003024624509724,0.0002589718060214,0.0002211013034250,0.0001882206341618,0.0001597567595103,0.0001351904310044,0.0001140527140378,0.0000959215434708,0.0000804183368393,0.0000672046879168,0.0000559791604780,0.0000464741992165,0.0000384531718993,0.0000317075540605,0.0000260542648585,0.0000213331601928,0.0000174046868102,0.0000141476989571,0.0000114574371628,0.0000092436669834,0.0000074289739992,0.0000059472100479,0.0000047420845823,0.0000037658941592,0.0000029783823948,0.0000023457222312,0.0000018396120561,0.0000014364770644,0.0000011167672494,0.0000008643435268,0.0000006659437208,0.0000005107204556,0.0000003898433769,0.0000002961585657,0.0000002238984811,0.0000001684362698,0.0000001260787874,0.0000000938931912,0.0000000695624661,0.0000000512657296,0.0000000375796303,0.0000000273975862,0.0000000198640202,0.0000000143211201,0.0000000102659963,0.0000000073164111,0.0000000051835333,0.0000000036504104,0.0000000025550654,0.0000000017773077];
            testCase.verifyEqual(unconditional_ideal_open_pdf',result,'AbsTol', 1e-10);
        end
        
        function testUnconditionalIdealShutPdf(testCase)
            unconditional_exact_shut_pdf = UnconditionalIdealPDF(testCase.qm,testCase.kA,testCase.kF,testCase.tres,testCase.t,0,testCase.dcpoptions);
            result=[0.0820653561435907,0.0831690636258576,0.0842831865159345,0.0854076718271376,0.0865424599817402,0.0876874846206476,0.0888426723240533,0.0900079424307561,0.0911832068066892,0.0923683696024968,0.0935633270068387,0.0947679670322500,0.0959821692710058,0.0972058046286384,0.0984387351018622,0.0996808135156418,0.1009318832686018,0.1021917780805034,0.1034603217531260,0.1047373278699690,0.1060225995905498,0.1073159293273789,0.1086170985392975,0.1099258774210324,0.1112420246741480,0.1125652872207099,0.1138953999378414,0.1152320854119714,0.1165750536499503,0.1179240018270444,0.1192786140442917,0.1206385610404982,0.1220034999415299,0.1233730740203581,0.1247469124533384,0.1261246300410355,0.1275058270042346,0.1288900887214945,0.1302769855182109,0.1316660724414740,0.1330568890364703,0.1344489591343502,0.1358417906772925,0.1372348755078504,0.1386276891976646,0.1400196908851249,0.1414103231072593,0.1427990116752831,0.1441851655340446,0.1455681766472079,0.1469474199115166,0.1483222530671218,0.1496920166322790,0.1510560338764252,0.1524136107727488,0.1537640360128218,0.1551065810271038,0.1564405000147588,0.1577650300261436,0.1590793910558732,0.1603827861500149,0.1616744015793200,0.1629534069929812,0.1642189556543658,0.1654701846671050,0.1667062152563856,0.1679261530855615,0.1691290885971988,0.1703140974031024,0.1714802407088523,0.1726265657706440,0.1737521064168646,0.1748558835778160,0.1759369058970439,0.1769941703566955,0.1780266629669373,0.1790333594973330,0.1800132262592423,0.1809652209317749,0.1818882934506169,0.1827813869327795,0.1836434386700385,0.1844733811611339,0.1852701432111974,0.1860326510728953,0.1867598296568900,0.1874506037847274,0.1881038995062648,0.1887186454680874,0.1892937743453503,0.1898282243174494,0.1903209406117247,0.1907708770960052,0.1911769979261780,0.1915382792470323,0.1918537109499097,0.1921222984770740,0.1923430646785703,0.1925150517175360,0.1926373230209386,0.1927089652765150,0.1927290904697859,0.1926968379618309,0.1926113766028187,0.1924719068792885,0.1922776630903873,0.1920279155508640,0.1917219728152063,0.1913591839210676,0.1909389406410138,0.1904606797484734,0.1899238852809277,0.1893280908014662,0.1886728816520405,0.1879578971918845,0.1871828330102281,0.1863474431163155,0.1854515420861198,0.1844950071739956,0.1834777803651879,0.1823998703750403,0.1812613545790642,0.1800623808647854,0.1788031694064293,0.1774840143352795,0.1761052853202856,0.1746674290302265,0.1731709704712853,0.1716165142087949,0.1700047454376833,0.1683364309060796,0.1666124196868679,0.1648336437812913,0.1630011185404008,0.1611159429101851,0.1591792994785036,0.1571924543254671,0.1551567566553807,0.1530736382231798,0.1509446125318087,0.1487712737924620,0.1465552956627593,0.1442984297288140,0.1420025037541785,0.1396694196655546,0.1373011512921193,0.1348997418564146,0.1324673011906786,0.1300060027193707,0.1275180801629288,0.1250058240094437,0.1224715777197017,0.1199177336974658,0.1173467290139698,0.1147610409027514,0.1121631820245289,0.1095556955292467,0.1069411498993481,0.1043221336162961,0.1017012496376322,0.0990811097238122,0.0964643286113707,0.0938535180612311,0.0912512808023097,0.0886602043853366,0.0860828549669147,0.0835217710632982,0.0809794572666465,0.0784583779866497,0.0759609512085804,0.0734895423173355,0.0710464580016657,0.0686339402761433,0.0662541606367553,0.0639092143846988,0.0616011151522558,0.0593317896404171,0.0571030726172560,0.0549167021831862,0.0527743153464615,0.0506774439209462,0.0486275107746001,0.0466258264533746,0.0446735861960151,0.0427718673626889,0.0409216272941120,0.0391237016117636,0.0373788029775059,0.0356875203207237,0.0340503185382684,0.0324675386746850,0.0309393985834515,0.0294659940711928,0.0280473005154779,0.0266831749555342,0.0253733586424194,0.0241174800359022,0.0229150582349340,0.0217655068201603,0.0206681380897291,0.0196221676607823,0.0186267194136462,0.0176808307483736,0.0167834581207500,0.0159334828285315,0.0151297170090402,0.0143709098147517,0.0136557537288941,0.0129828909826943,0.0123509200356882,0.0117584020812567,0.0112038675370973,0.0106858224848266,0.0102027550194258,0.0097531414733378,0.0093354524803853,0.0089481588472479,0.0085897372001034,0.0082586753798635,0.0079534775582725,0.0076726690525974,0.0074148008187000,0.0071784536044256,0.0069622417500738,0.0067648166248220,0.0065848696917573,0.0064211351970353,0.0062723924827380,0.0061374679252882,0.0060152365048193,0.0059046230138947,0.0058046029165023,0.0057142028707180,0.0056325009310741,0.0055586264483860,0.0054917596867021,0.0054311311786267,0.0053760208412509,0.0053257568760281,0.0052797144763843,0.0052373143672927,0.0051980212009328,0.0051613418323567,0.0051268234986560,0.0050940519241688,0.0050626493735498,0.0050322726731451,0.0050026112199685,0.0049733849960027,0.0049443426040480,0.0049152593396736,0.0048859353121271,0.0048561936253850,0.0048258786287389,0.0047948542447143,0.0047630023803801,0.0047302214266903,0.0046964248488344,0.0046615398693755,0.0046255062445840,0.0045882751332624,0.0045498080563674,0.0045100759448470,0.0044690582723277,0.0044267422687229,0.0043831222103314,0.0043381987815393,0.0042919785031562,0.0042444732220263,0.0041956996567128,0.0041456789939142,0.0040944365304696,0.0040420013558656,0.0039884060704542,0.0039336865347892,0.0038778816457537,0.0038210331354980,0.0037631853894504,0.0037043852800875,0.0036446820133474,0.0035841269849807,0.0035227736444052,0.0034606773639436,0.0033978953115670,0.0033344863255574,0.0032705107897852,0.0032060305084416,0.0031411085793430,0.0030758092650922,0.0030101978615486,0.0029443405632378,0.0028783043254318,0.0028121567228071,0.0027459658046581,0.0026797999467866,0.0026137277002237,0.0025478176370638,0.0024821381937732,0.0024167575123453,0.0023517432797524,0.0022871625662488,0.0022230816630419,0.0021595659199037,0.0020966795834091,0.0020344856363823,0.0019730456392572,0.0019124195740503,0.0018526656916230,0.0017938403629618,0.0017359979351957,0.0016791905930296,0.0016234682263570,0.0015688783046770,0.0015154657590411,0.0014632728721752,0.0014123391773728,0.0013627013667880,0.0013143932096649,0.0012674454810132,0.0012218859012003,0.0011777390868691,0.0011350265135336,0.0010937664901426,0.0010539741458424,0.0010156614290958,0.0009788371192442,0.0009435068505261,0.0009096731484940,0.0008773354786770,0.0008464903072903,0.0008171311736840,0.0007892487741608,0.0007628310567171,0.0007378633261860,0.0007143283591863,0.0006922065282205,0.0006714759341989,0.0006521125466059,0.0006340903504778,0.0006173814993075,0.0006019564729637,0.0005877842396615,0.0005748324210147,0.0005630674591766,0.0005524547850567,0.0005429589866261,0.0005345439763025,0.0005271731564496,0.0005208095820350,0.0005154161195301,0.0005109556011792,0.0005073909738118,0.0005046854414301,0.0005028026008662,0.0005017065698736,0.0005013621070902,0.0005017347233893,0.0005027907842148,0.0005044976025835,0.0005068235225192,0.0005097379927718,0.0005132116307576,0.0005172162767420,0.0005217250383661,0.0005267123256964,0.0005321538770500,0.0005380267759182,0.0005443094593696,0.0005509817183761,0.0005580246905496,0.0005654208458222,0.0005731539656385,0.0005812091162510,0.0005895726167362,0.0005982320023527,0.0006071759838746,0.0006163944035240,0.0006258781881188,0.0006356193000378,0.0006456106865801,0.0006558462282680,0.0006663206866127,0.0006770296518261,0.0006879694909190,0.0006991372965917,0.0007105308372710,0.0007221485086129,0.0007339892867377,0.0007460526834254,0.0007583387034564,0.0007708478042368,0.0007835808578143,0.0007965391153504,0.0008097241740800,0.0008231379467621,0.0008367826335942,0.0008506606965402,0.0008647748360012,0.0008791279697397,0.0008937232139543,0.0009085638663907,0.0009236533913673,0.0009389954065863,0.0009545936716007,0.0009704520778063,0.0009865746398276,0.0010029654881712,0.0010196288630248,0.0010365691090840,0.0010537906712975,0.0010712980914268,0.0010890960053234,0.0011071891408388,0.0011255823162839,0.0011442804393666,0.0011632885065426,0.0011826116027214,0.0012022549012768,0.0012222236643170,0.0012425232431747,0.0012631590790858,0.0012841367040242,0.0013054617416735,0.0013271399085098,0.0013491770149819,0.0013715789667735,0.0013943517661347,0.0014175015132754,0.0014410344078106,0.0014649567502519,0.0014892749435424,0.0015139954946269,0.0015391250160596,0.0015646702276415,0.0015906379580913,0.0016170351467433,0.0016438688452757,0.0016711462194660,0.0016988745509745,0.0017270612391553,0.0017557138028935,0.0017848398824716,0.0018144472414622,0.0018445437686483,0.0018751374799728,0.0019062365205133,0.0019378491664892,0.0019699838272938,0.0020026490475575,0.0020358535092394,0.0020696060337488,0.0021039155840962,0.0021387912670746,0.0021742423354715,0.0022102781903112,0.0022469083831288,0.0022841426182748,0.0023219907552523,0.0023604628110853,0.0023995689627204,0.0024393195494600,0.0024797250754289,0.0025207962120747,0.0025625438007007,0.0026049788550331,0.0026481125638224,0.0026919562934790,0.0027365215907437,0.0027818201853925,0.0028278639929777,0.0028746651176029,0.0029222358547355,0.0029705886940537,0.0030197363223306,0.0030696916263544,0.0031204676958850,0.0031720778266485,0.0032245355233672,0.0032778545028289,0.0033320486969918,0.0033871322561282,0.0034431195520055,0.0035000251811065,0.0035578639678851,0.0036166509680634,0.0036764014719653,0.0037371310078890,0.0037988553455183,0.0038615904993725,0.0039253527322948,0.0039901585589794,0.0040560247495383,0.0041229683331052,0.0041910066014798,0.0042601571128096,0.0043304376953108,0.0044018664510282,0.0044744617596319,0.0045482422822552,0.0046232269653668,0.0046994350446843,0.0047768860491232,0.0048555998047851,0.0049355964389805,0.0050168963842912,0.0050995203826677,0.0051834894895624,0.0052688250780990,0.0053555488432768,0.0054436828062101,0.0055332493184010,0.0056242710660458];
            testCase.verifyEqual(unconditional_exact_shut_pdf',result,'AbsTol', 1e-10);
        end              
        
        function testUnconditionalOpenCdf(testCase)
            unconditional_open_cdf = UnconditionalExactCDF(testCase.qm,testCase.kA,testCase.kF,testCase.tres,testCase.t,1,testCase.dcpoptions);
            result=[0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0002674204714943,0.0007559369680645,0.0012517283656154,0.0017548901115035,0.0022655185158400,0.0027837107508488,0.0033095648410274,0.0038431796620082,0.0043846549324932,0.0049340912090539,0.0054915898768689,0.0060572531472578,0.0066311840442445,0.0072134863990096,0.0078042648407513,0.0084036247862391,0.0090116724286036,0.0096285147287197,0.0102542594006836,0.0108890149026443,0.0115328904205713,0.0121859958573067,0.0128484418167581,0.0135203395888331,0.0142018011350592,0.0148929390693185,0.0155938666442148,0.0163046977297414,0.0170255467953133,0.0177565288928826,0.0184977596323450,0.0192493551624038,0.0200114321496948,0.0207841077545463,0.0215674996066361,0.0223617257826673,0.0231669047795450,0.0239831554889924,0.0248105971692778,0.0256493494199262,0.0264995321508353,0.0273612655527542,0.0282366201048553,0.0291251865825480,0.0300257167217132,0.0309383289635158,0.0318631416628000,0.0328002730455169,0.0337498411625221,0.0347119638496356,0.0356867586778185,0.0366743429116471,0.0376748334584737,0.0386883468232707,0.0397149990583289,0.0407549057145194,0.0418081817905332,0.0428749416836652,0.0439552991351022,0.0450493671808174,0.0461572580960259,0.0472790833442574,0.0484149535210918,0.0495649783010589,0.0507292663832508,0.0519079254352223,0.0531009313976198,0.0543050245202051,0.0555237444796727,0.0567571932604404,0.0580054715201741,0.0592686785371717,0.0605469121541062,0.0618402687244094,0.0631488430561886,0.0644727283598767,0.0658120161963819,0.0671667964221683,0.0685371571415404,0.0699231846537668,0.0713249634071106,0.0727425759493530,0.0741761028826970,0.0756256228204071,0.0770912123435458,0.0785729459615167,0.0800708960738659,0.0815851329335149,0.0831157246150655,0.0846627369839267,0.0862262336677778,0.0878062760326636,0.0894029231617115,0.0910162318379170,0.0926462565282211,0.0942930493749425,0.0959566601884152,0.0976371364448039,0.0993345232896347,0.1010488635439332,0.1027801977168377,0.1045285640212099,0.1062939983976446,0.1080765345418024,0.1098762039368932,0.1116930358949807,0.1135270576002134,0.1153782941619666,0.1172467686729442,0.1191325022735842,0.1210355142236687,0.1229558219816117,0.1248934412889390,0.1268483862652676,0.1288206695068400,0.1308103021950005,0.1328172942120615,0.1348416542653333,0.1368833900161741,0.1389425082215359,0.1410190148784384,0.1431129153801786,0.1452242146796132,0.1473529174578120,0.1494990283041446,0.1516625519021875,0.1538434932237188,0.1560418577293066,0.1582576515788927,0.1604908818465571,0.1627415567434957,0.1650096858488433,0.1672952803457663,0.1695983532628340,0.1719189197233774,0.1742569971983174,0.1766126057645000,0.1789857683685797,0.1813765110928725,0.1837848634262070,0.1862108585364246,0.1886545335464980,0.1911159298103219,0.1935950931900574,0.1960920743350062,0.1986069289560917,0.2011397181029477,0.2036905084345488,0.2062593724896446,0.2088463889504633,0.2114516429022091,0.2140752260856370,0.2167172371421386,0.2193777818512231,0.2220569733563684,0.2247549323819452,0.2274717874361362,0.2302076750039265,0.2329627397211333,0.2357371345372165,0.2385310208586143,0.2413445686745916,0.2441779566645339,0.2470313722844523,0.2499050118310147,0.2527990804842124,0.2557137923255520,0.2586493703297361,0.2616060463334438,0.2645840609726451,0.2675836635957322,0.2706051121449505,0.2736486730092058,0.2767146208445262,0.2798032383646297,0.2829148160984741,0.2860496521146167,0.2892080517130807,0.2923903270826090,0.2955967969254166,0.2988277860457218,0.3020836249055959,0.3053646491462579,0.3086711990753166,0.3120036191196064,0.3153622572453287,0.3187474643459298,0.3221595935964064,0.3255989997772575,0.3290660385677715,0.3325610658098227,0.3360844367436492,0.3396365052161050,0.3432176228641968,0.3468281382740808,0.3504683961181783,0.3541387362708424,0.3578394929061253,0.3615709935789518,0.3653335582902799,0.3691274985401919,0.3729531163714692,0.3768107034032541,0.3807005398590486,0.3846228935923808,0.3885780191087531,0.3925661565900908,0.3965875309222610,0.4006423507272711,0.4047308074041209,0.4088530741794971,0.4130093051699799,0.4171996344604473,0.4214241751963310,0.4256830186968616,0.4299762335874032,0.4343038649532430,0.4386659335188079,0.4430624348510928,0.4474933385900166,0.4519585877073623,0.4564580977948171,0.4609917563822367,0.4655594222872651,0.4701609249972917,0.4747960640840434,0.4794646086515437,0.4841662968177756,0.4889008352305341,0.4936678986170507,0.4984671293691212,0.5032981371615363,0.5081604986051277,0.5130537569343175,0.5179774217286242,0.5229309686675616,0.5279138393195859,0.5329254409642049,0.5379651464467666,0.5430322940664182,0.5481261874961592,0.5532460957359908,0.5583912530966738,0.5635608592171644,0.5687540791133610,0.5739700432581556,0.5792078476955973,0.5844665541849511,0.5897451903798389,0.5950427500390324,0.6003581932712000,0.6056904468144082,0.6110384043503682,0.6164009268541742,0.6217768429814665,0.6271649494930042,0.6325640117182572,0.6379727640588877,0.6433899105339259,0.6488141253672585,0.6542440536189675,0.6596783118627737,0.6651154889090674,0.6705541465771584,0.6759928205164989,0.6814300210786106,0.6868642342421821,0.6922939225903376,0.6977175263440564,0.7031334644503031,0.7085401357274201,0.7139359200686115,0.7193191797033629,0.7246882605186783,0.7300414934393924,0.7353771958689355,0.7406936731897807,0.7459892203243870,0.7512621233557615,0.7565106612069576,0.7617331073797434,0.7669277317505444,0.7720928024232651,0.7772265876364945,0.7823273577251055,0.7873933871321437,0.7924229564711871,0.7974143546342778,0.8023658809450139,0.8072758473517238,0.8121425806589740,0.8169644247929416,0.8217397430970630,0.8264669206539258,0.8311443666288933,0.8357705166307029,0.8403438350844410,0.8448628176111388,0.8493259934090067,0.8537319276307572,0.8580792237502488,0.8623665259134559,0.8665925212664380,0.8707559422544472,0.8748555688851561,0.8788902309490830,0.8828588101906363,0.8867602424222256,0.8905935195743627,0.8943576916747794,0.8980518687489333,0.9016752226348649,0.9052269887050831,0.9087064674880466,0.9121130261825716,0.9154461000579202,0.9187051937327189,0.9218898823261714,0.9249998124752630,0.9280347032116631,0.9309943466927837,0.9338786087812798,0.9366874294682556,0.9394208231352579,0.9420788786512653,0.9446617593006938,0.9471697025396754,0.9496030195778825,0.9519620947840852,0.9542473849143169,0.9564594181619083,0.9585987930296738,0.9606661770251177,0.9626623051801677,0.9645879783980449,0.9664440616301415,0.9682314818871331,0.9699512260888714,0.9716043387586601,0.9731919195682416,0.9747151207404809,0.9761751443177141,0.9775732393041293,0.9789106986916911,0.9801888563793062,0.9814090839959773,0.9825727876390182,0.9836814045389953,0.9847363996637140,0.9857392622736615,0.9866915024420265,0.9875946475524502,0.9884502387880083,0.9892598276250243,0.9900249723453596,0.9907472345808545,0.9914281759034101,0.9920693544741006,0.9926723217643282,0.9932386193617727,0.9937697758733680,0.9942673039370361,0.9947326973532976,0.9951674283472076,0.9955729449702951,0.9959506686513486,0.9963019919040449,0.9966282761984430,0.9969308500024037,0.9972110069979451,0.9974700044765095,0.9977090619160229,0.9979293597415326,0.9981320382701099,0.9983181968396113,0.9984888931197993,0.9986451426032756,0.9987879182726447,0.9989181504393421,0.9990367267486232,0.9991444923443378,0.9992422501862934,0.9993307615122757,0.9994107464361326,0.9994828846727453,0.9995478163802233,0.9996061431092564,0.9996584288492470,0.9997052011606404,0.9997469523827337,0.9997841409062374,0.9998171924999062,0.9998465016807206,0.9998724331173250,0.9998953230567419,0.9999154807647711,0.9999331899709205,0.9999487103092367,0.9999622787469508,0.9999741109934659,0.9999844028828455,0.9999933317236160,1.0000010576103957,1.0000077246925296,1.0000134623956134,1.0000183865924686,1.0000226007207960,1.0000261968453916,1.0000292566634155,1.0000318524518099,1.0000340479564995,1.0000358992235219,1.0000374553727087,1.0000387593149433];
            testCase.verifyEqual(unconditional_open_cdf',result,'AbsTol', 1e-10);
        end
        
        function testUnconditionalShutCdf(testCase)
            unconditional_shut_cdf = UnconditionalExactCDF(testCase.qm,testCase.kA,testCase.kF,testCase.tres,testCase.t,0,testCase.dcpoptions);
            result=[0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0044244965855948,0.0124187591820769,0.0204166553474237,0.0284160969079432,0.0364149621697177,0.0444110972578960,0.0524023174080722,0.0603864084910812,0.0683611285289402,0.0763242093541758,0.0842733583098240,0.0922062601474309,0.1001205788684585,0.1080139597797120,0.1158840315972349,0.1237284086327712,0.1315446930702927,0.1393304773738500,0.1470833467159440,0.1548008815690928,0.1624806603022760,0.1701202619334557,0.1777172689109119,0.1852692699894729,0.1927738631955578,0.2002286588157159,0.2076312825211897,0.2149793784778098,0.2222706125580910,0.2295026756216159,0.2366732867713305,0.2437801967135462,0.2508211911401288,0.2577940941131672,0.2646967714773647,0.2715271343096639,0.2782831423401743,0.2849628073896869,0.2915641967779010,0.2980854367416488,0.3045247157844980,0.3108802880057268,0.3171561077539600,0.3233488595820430,0.3294527350673602,0.3354659437841274,0.3413867659680755,0.3472135556968280,0.3529447439761941,0.3585788417821386,0.3641144429483851,0.3695502269985109,0.3748849618079763,0.3801175061716245,0.3852468122048620,0.3902719276047496,0.3951919977412831,0.4000062675857617,0.4047140834335128,0.4093148944622927,0.4138082540622828,0.4181938209772854,0.4224713602065396,0.4266407436943214,0.4307019507811881,0.4346550684097284,0.4384998561801821,0.4422254130322331,0.4458435842850401,0.4493548810988945,0.4527599195562028,0.4560594194042517,0.4592542025291401,0.4623451911792648,0.4653334059268584,0.4682199633857013,0.4710060736799881,0.4736930376626485,0.4762822439107687,0.4787751654795928,0.4811733564476220,0.4834784482423337,0.4856921457719264,0.4878162233693414,0.4898525205590861,0.4918029376662765,0.4936694312785492,0.4954540095770792,0.4971587275574165,0.4987856821517766,0.5003370072728665,0.5018148687998661,0.5032214595230321,0.5045589940675257,0.5058297038135959,0.5070358318377967,0.5081796278895968,0.5092633434262888,0.5102892267255162,0.5112595180923477,0.5121764451819402,0.5130422184536337,0.5138590267765962,0.5146290332005943,0.5153543709085515,0.5160371393667360,0.5166794006829823,0.5172831761882568,0.5178504432502218,0.5183831323287752,0.5188831242817189,0.5193522479270014,0.5197922778657528,0.5202049325706873,0.5205918727399005,0.5209546999176906,0.5212949553802728,0.5216141192835262,0.5219136100677921,0.5221947841149503,0.5224589356489310,0.5227072968723523,0.5229410383286907,0.5231612694788956,0.5233690394811633,0.5235653381603323,0.5237510971535549,0.5239271912178373,0.5240944396849643,0.5242536080481803,0.5244054096656173,0.5245505075649349,0.5246895163335681,0.5248230040793312,0.5249514944465616,0.5250754686729353,0.5251953676730176,0.5253115941350734,0.5254245146181906,0.5255344616378825,0.5256417357288571,0.5257466074748002,0.5258493194956826,0.5259500883843494,0.5260491065850286,0.5261465442071763,0.5262425507695768,0.5263372568699550,0.5264307757769088,0.5265232049413888,0.5266146274261698,0.5267051132523716,0.5267947206629457,0.5268834973037385,0.5269714813232531,0.5270587023930254,0.5271451826507609,0.5272309375691026,0.5273159767528346,0.5274003046681549,0.5274839213073473,0.5275668227926866,0.5276490019233963,0.5277304486695009,0.5278111506164241,0.5278910933642238,0.5279702608851401,0.5280486358430544,0.5281261998784594,0.5282029338620460,0.5282788181202446,0.5283538326354741,0.5284279572239096,0.5285011716932114,0.5285734559825761,0.5286447902871366,0.5287151551686011,0.5287845316538373,0.5288529013228550,0.5289202463875561,0.5289865497623222,0.5290517951275168,0.5291159669867064,0.5291790507183437,0.5292410326224994,0.5293018999631836,0.5293616410066607,0.5294202450560628,0.5294777024826033,0.5295340047535791,0.5295891444573148,0.5296431153251626,0.5296959122506254,0.5297475313056674,0.5297979697542210,0.5298472260629034,0.5298952999089297,0.5299421921852234,0.5299879050027002,0.5300324416896806,0.5300758067884418,0.5301180060488871,0.5301590464192912,0.5301989360341408,0.5302376841990760,0.5302753013729102,0.5303117991467807,0.5303471902204473,0.5303814883757738,0.5304147084474594,0.5304468662910751,0.5304779787484828,0.5305080636107429,0.5305371395785810,0.5305652262205695,0.5305923439291168,0.5306185138744179,0.5306437579565190,0.5306680987556501,0.5306915594810003,0.5307141639181179,0.5307359363751207,0.5307569016279197,0.5307770848646522,0.5307965116295453,0.5308152077664150,0.5308331993620252,0.5308505126895230,0.5308671741521764,0.5308832102276299,0.5308986474129060,0.5309135121703602,0.5309278308748061,0.5309416297620171,0.5309549348788040,0.5309677720348542,0.5309801667565209,0.5309921442427251,0.5310037293231307,0.5310149464187388,0.5310258195050255,0.5310363720777427,0.5310466271214781,0.5310566070810575,0.5310663338358524,0.5310758286770417,0.5310851122878575,0.5310942047268236,0.5311031254139846,0.5311118931200998,0.5311205259587575,0.5311290413813617,0.5311374561749064,0.5311457864624556,0.5311540477062257,0.5311622547131490,0.5311704216427992,0.5311785620175260,0.5311866887346689,0.5311948140806738,0.5312029497469652,0.5312111068473970,0.5312192959371150,0.5312275270326550,0.5312358096331018,0.5312441527421410,0.5312525648908273,0.5312610541609046,0.5312696282085181,0.5312782942881593,0.5312870592766988,0.5312959296973641,0.5313049117435318,0.5313140113022178,0.5313232339771438,0.5313325851112917,0.5313420698088493,0.5313516929564710,0.5313614592437869,0.5313713731831048,0.5313814391282599,0.5313916612925765,0.5314020437659207,0.5314125905308232,0.5314233054776748,0.5314341924189885,0.5314452551027438,0.5314564972248293,0.5314679224406036,0.5314795343756046,0.5314913366354423,0.5315033328149061,0.5315155265063291,0.5315279213072522,0.5315405208274274,0.5315533286952079,0.5315663485633647,0.5315795841143816,0.5315930390652607,0.5316067171718937,0.5316206222330301,0.5316347580938853,0.5316491286494264,0.5316637378473703,0.5316785896909285,0.5316936882413240,0.5317090376201193,0.5317246420113695,0.5317405056636323,0.5317566328918545,0.5317730280791532,0.5317896956785109,0.5318066402143982,0.5318238662843402,0.5318413785604345,0.5318591817908375,0.5318772808012235,0.5318956804962244,0.5319143858608597,0.5319334019619621,0.5319527339496022,0.5319723870585155,0.5319923666095415,0.5320126780110690,0.5320333267604987,0.5320543184457182,0.5320756587465967,0.5320973534364988,0.5321194083838162,0.5321418295535243,0.5321646230087588,0.5321877949124166,0.5322113515287812,0.5322352992251715,0.5322596444736173,0.5322843938525603,0.5323095540485816,0.5323351318581557,0.5323611341894328,0.5323875680640475,0.5324144406189583,0.5324417591083137,0.5324695309053474,0.5324977635043060,0.5325264645224035,0.5325556417018071,0.5325853029116571,0.5326154561501133,0.5326461095464371,0.5326772713631049,0.5327089499979539,0.5327411539863611,0.5327738920034569,0.5328071728663732,0.5328410055365251,0.5328753991219281,0.5329103628795515,0.5329459062177098,0.5329820386984853,0.5330187700401955,0.5330561101198917,0.5330940689759008,0.5331326568104021,0.5331718839920455,0.5332117610586102,0.5332522987197030,0.5332935078594957,0.5333353995395078,0.5333779850014284,0.5334212756699824,0.5334652831558391,0.5335100192585639,0.5335554959696167,0.5336017254753932,0.5336487201603117,0.5336964926099487,0.5337450556142164,0.5337944221705928,0.5338446054873967,0.5338956189871109,0.5339474763097575,0.5340001913163180,0.5340537780922098,0.5341082509508089,0.5341636244370257,0.5342199133309353,0.5342771326514563,0.5343352976600867,0.5343944238646929,0.5344545270233529,0.5345156231482551,0.5345777285096546,0.5346408596398827,0.5347050333374189,0.5347702666710157,0.5348365769838854,0.5349039818979454,0.5349724993181221,0.5350421474367169,0.5351129447378340,0.5351849100018667,0.5352580623100511,0.5353324210490775,0.5354080059157710,0.5354848369218320,0.5355629343986442,0.5356423190021481,0.5357230117177796,0.5358050338654762,0.5358884071047514,0.5359731534398360,0.5360592952248888,0.5361468551692767,0.5362358563429236];
            testCase.verifyEqual(unconditional_shut_cdf',result,'AbsTol', 1e-10);
        end        

        function testConditionalExactOpenPdf(testCase)
            %conditional on shut time > tres but < 0.15ms
            open_conditional_distribution = ConditionalDistribution(testCase.qm,testCase.kA,testCase.kF,testCase.tres,0.15/1000,testCase.tres,testCase.t,1,testCase.dcpoptions);
            result = [0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0131588325413230,0.0133721468010292,0.0135888922362552,0.0138091244281303,0.0140328998939783,0.0142602761052683,0.0144913115019615,0.0147260655111007,0.0149645985627926,0.0152069721078810,0.0154532486342640,0.0157034916866467,0.0159577658818860,0.0162161369282547,0.0164786716435579,0.0167454379731025,0.0170165050077595,0.0172919430036160,0.0175718233994251,0.0178562188368748,0.0181452031781254,0.0184388515261329,0.0187372402432168,0.0190404469703706,0.0193485506472961,0.0196616315306367,0.0199797712151569,0.0203030526518333,0.0206315601678533,0.0209653794874971,0.0213045977498820,0.0216493035295577,0.0219995868566779,0.0223555392359820,0.0227172536660696,0.0230848246599454,0.0234583482638208,0.0238379220769002,0.0242236452701389,0.0246156186066959,0.0250139444600782,0.0254187268332006,0.0258301130989978,0.0262478861811608,0.0266722117264304,0.0271031857849143,0.0275409055923504,0.0279854695769539,0.0284369773647232,0.0288955297878827,0.0293612288887673,0.0298341779277761,0.0303144813869703,0.0308022449764463,0.0312975756382776,0.0318005815512004,0.0323113721342893,0.0328300580513128,0.0333567512123044,0.0338915647777099,0.0344346131591985,0.0349860120224881,0.0355458782872631,0.0361143301282987,0.0366914869755581,0.0372774695129854,0.0378723996771724,0.0384764006563378,0.0390895968857099,0.0397121140465245,0.0403440790596549,0.0409856200820392,0.0416368665003104,0.0422979489247143,0.0429689991806275,0.0436501503007432,0.0443415365161922,0.0450432932446435,0.0457555570805797,0.0464784657812556,0.0472121582544741,0.0479567745426548,0.0487124558071759,0.0494793443114984,0.0502575834020710,0.0510473174888398,0.0518486920238814,0.0526618534780983,0.0534869493177809,0.0543241279786201,0.0551735388378087,0.0560353321853210,0.0569096591931267,0.0577966718829596,0.0586965230909430,0.0596093664322281,0.0605353562620940,0.0614746476355055,0.0624273962652632,0.0633937584768224,0.0643738911617528,0.0653679517276910,0.0663760980476481,0.0673984884056132,0.0684352814392727,0.0694866360817680,0.0705527114983294,0.0716336670221842,0.0727296620866993,0.0738408561543278,0.0749674086426923,0.0761094788479040,0.0772672258634515,0.0784408084976315,0.0796303851852041,0.0808361138969007,0.0820581520451054,0.0832966563860152,0.0845517829161980,0.0858236867679696,0.0871125220975994,0.0884184419716181,0.0897415982482640,0.0910821414528737,0.0924402206509182,0.0938159833151129,0.0952095751879491,0.0966211401386560,0.0980508200167497,0.0994987544984415,0.1009650809284914,0.1024499341573316,0.1039534463718445,0.1054757469198655,0.1070169621303012,0.1085772151260309,0.1101566256310809,0.1117553097723053,0.1133733798733925,0.1150109442434690,0.1166681069583274,0.1183449676359224,0.1200416212037893,0.1217581576600319,0.1234946618282949,0.1252512131030575,0.1270278851905749,0.1288247458396769,0.1306418565673301,0.1324792723749671,0.1343370414579602,0.1362152049069645,0.1381137964014021,0.1400328418957172,0.1419723592962513,0.1439323581314416,0.1459128392124793,0.1479137942882018,0.1499352056884923,0.1519770459626935,0.1540392775078941,0.1561218521894297,0.1582247109537393,0.1603477834328563,0.1624909875402106,0.1646542290595101,0.1668374012253347,0.1690403842948461,0.1712630451142594,0.1735052366745734,0.1757667976629330,0.1780475520048713,0.1803473084006058,0.1826658598534321,0.1850029831928717,0.1873584385910013,0.1897319690725670,0.1921233000201164,0.1945321386732005,0.1969581736238511,0.1994010743060793,0.2018604904825819,0.2043360517276876,0.2068273669073192,0.2093340236560464,0.2118555878527997,0.2143916030957884,0.2169415901758030,0.2195050465504304,0.2220814458189922,0.2246702371990853,0.2272708450057648,0.2298826681336424,0.2325050795438335,0.2351374257557010,0.2377790263451371,0.2404291734494617,0.2430871312812681,0.2457521356518734,0.2484233935045267,0.2511000824599434,0.2537813503756946,0.2564663149189397,0.2591540631552970,0.2618436511559853,0.2645341036221517,0.2672244135306211,0.2699135418014239,0.2726004169882808,0.2752839349948757,0.2779629588179384,0.2806363183186061,0.2833028100255596,0.2859611969689883,0.2886102085506523,0.2912485404495999,0.2938748545660037,0.2964877790066167,0.2990859081122738,0.3016678025304368,0.3042319893352025,0.3067769621966548,0.3093011816019270,0.3118030751304527,0.3142810377858943,0.3167334323869592,0.3191585900196625,0.3215548105534549,0.3239203632237986,0.3262534872833814,0.3285523927252799,0.3308152610794712,0.3330402462858947,0.3352254756465332,0.3373690508587994,0.3394690491325231,0.3415235243933272,0.3435305085744569,0.3454880129992633,0.3473940298568586,0.3492465337727284,0.3510434834767767,0.3527828235698738,0.3544624863918493,0.3560803939917108,0.3576344602016470,0.3591225928169449,0.3605426958816190,0.3618926720821415,0.3631704252488593,0.3643738629661183,0.3655008992913255,0.3665494575827069,0.3675174734354333,0.3684028977256472,0.3692036997611821,0.3699178705377306,0.3705434260986959,0.3710784109966812,0.3715209018539998,0.3718690110192907,0.3721208903168778,0.3722747348848620,0.3723287870977207,0.3722813405684359,0.3721307442248100,0.3718754064540008,0.3715137993088313,0.3710444627687402,0.3704660090478394,0.3697771269418074,0.3689765862047596,0.3680632419467947,0.3670360390420302,0.3658940165366694,0.3646363120456805,0.3632621661264061,0.3617709266164626,0.3601620529230081,0.3584351202498555,0.3565898237479708,0.3546259825749095,0.3525435438476991,0.3503425864738402,0.3480233248435760,0.3455861123677129,0.3430314448429816,0.3403599636287261,0.3375724586162074,0.3346698709737370,0.3316532956488497,0.3285239836099205,0.3252833438089897,0.3219329448476888,0.3184745163284256,0.3149099498732118,0.3112412997925155,0.3074707833876122,0.3036007808696560,0.2996338348795035,0.2955726495939452,0.2914200894031124,0.2871791771466519,0.2828530918958538,0.2784451662710165,0.2739588832844529,0.2693978727004534,0.2647659069060026,0.2600668962871766,0.2553048841076975,0.2504840408887976,0.2456086582908637,0.2406831424998422,0.2357120071238925,0.2306998656071879,0.2256514231711259,0.2205714682954271,0.2154648637539987,0.2103365372230344,0.2051914714819142,0.2000346942294586,0.1948712675416431,0.1897062769985987,0.1845448205124370,0.1793919968889128,0.1742528941597465,0.1691325777236397,0.1640360783374323,0.1589683800005505,0.1539344077778598,0.1489390156085746,0.1439869741499448,0.1390829587061984,0.1342315372947941,0.1294371589021993,0.1247041419833936,0.1200366632583223,0.1154387468597739,0.1109142538862619,0.1064668724130535,0.1021001080138006,0.0978172748433446,0.0936214873314503,0.0895156525339162,0.0855024631864214,0.0815843915024106,0.0777636837538750,0.0740423556701175,0.0704221886851305,0.0669047270609741,0.0634912759088300,0.0601829001253462,0.0569804242563586,0.0538844332948002,0.0508952744141616,0.0480130596329812,0.0452376694003171,0.0425687570860147,0.0400057543540766,0.0375478773912862,0.0351941339578036,0.0329433312207945,0.0307940843268665,0.0287448256639224,0.0267938147583534,0.0249391487491455,0.0231787733763751,0.0215104944181314,0.0199319895068766,0.0184408202538175,0.0170344446078977,0.0157102293747855,0.0144654628205801,0.0132973672848506,0.0122031117283463,0.0111798241419198,0.0102246037450940,0.0093345329053048,0.0085066887118904,0.0077381541427011,0.0070260287653087,0.0063674389196548,0.0057595473340156,0.0051995621317772,0.0046847451923223,0.0042124198354775,0.0037799778052135,0.0033848855347175,0.0030246896813916,0.0026970219267010,0.0023996030421030,0.0021302462283724,0.0018868597415028,0.0016674488238799,0.0014701169646063,0.0012930665175703,0.0011345987101362,0.0009931130790646,0.0008671063734924,0.0007551709674468,0.0006559928264289,0.0005683490740960,0.0004911052059692,0.0004232119974427,0.0003637021531585,0.0003116867440919,0.0002663514774843,0.0002269528431123,0.0001928141773375,0.0001633216839875,0.0001379204484355,0.0001161104783179,0.0000974428012263,0.0000815156464714];
            testCase.verifyEqual(open_conditional_distribution',result,'AbsTol', 1e-10);
        end
        
        function testConditionalExactMeanOpenToShut(testCase)
            tint = [0.05 0.1;0.1 0.2; 0.2 1; 1 30; 30 300; 300 3000; 3000,30000;]/1000;
            conditional_mean_open = zeros(size(tint,1),1);
            conditional_mean_close = zeros(size(tint,1),1);
            empirical_mean_open = zeros(size(tint,1),1);
            empirical_mean_close = zeros(size(tint,1),1);
            empirical_std_open = zeros(size(tint,1),1);
            empirical_n_open = zeros(size(tint,1),1);
            
            %load data
            
            %[open, shut] = RecordingManipulator.getPeriods(testCase.resolvedIntervals);
            
            for i=1:size(tint,1)
                conditional_mean_open(i) = ConditionalMean(testCase.qm,testCase.kA,testCase.kF,testCase.tres,tint(i,2),tint(i,1),testCase.dcpoptions);
                conditional_mean_close(i) = ConditionalMeanPreceeding(testCase.qm,testCase.kA,testCase.kF,testCase.tres,tint(i,2),tint(i,1),testCase.dcpoptions);
                empirical_mean_open(i) = mean(RecordingManipulator.getSuceedingPeriodsWithRange(testCase.resolvedIntervals,1,tint(i,:)));
                empirical_mean_close(i) =  mean(RecordingManipulator.getPeriodsWithRange(testCase.resolvedIntervals,0,tint(i,:)));
                empirical_std_open(i) = std(RecordingManipulator.getSuceedingPeriodsWithRange(testCase.resolvedIntervals,1,tint(i,:)));
                empirical_n_open(i) = length(RecordingManipulator.getSuceedingPeriodsWithRange(testCase.resolvedIntervals,1,tint(i,:)));
            end
            
            testCase.verifyEqual(conditional_mean_open',[0.0039856555252439,0.0039788005699153,0.0038354378016064,0.0031519243425749,0.0031258317837989,0.0031258317837989,0.0031258317837989],'AbsTol', 1e-10);
            testCase.verifyEqual(conditional_mean_close',[0.0000711572773281,0.0001356114263918,0.0003013102382356,0.0105806748683092,0.1634628334610901,1.4974542925850078,6.9226240713372116],'AbsTol', 1e-10);
            testCase.verifyEqual(empirical_mean_open',[0.0039385692367428,0.0038864127753552,0.0038587522179929,0.0034538982783553,0.0031277063993002,0.0029887643743741,0.0030193030290494],'AbsTol', 1e-10);
            testCase.verifyEqual(empirical_mean_close',[0.0000709633915837,0.0001352899589552,0.0002999483149360,0.0115085601450748,0.1559885798269314,1.4898990528011826,6.9042951267740609],'AbsTol', 1e-10);
            testCase.verifyEqual(empirical_std_open',[0.0039175705322397,0.0038828513914378,0.0040397721834682,0.0035759228099811,0.0039283585209223,0.0034744176938984,0.0036701135665425],'AbsTol', 1e-10);
            testCase.verifyEqual(empirical_n_open',[6655,3784,849,110,652,4661,4641],'AbsTol', 1e-10);
        end     
        
        function testContinuousConditionalMean(testCase)
            t1=testCase.tres:0.00003:0.03;
            continuous_conditional_mean = zeros(size(t1,1),1);
            for i=1:size(t1,2)
                continuous_conditional_mean(i) = ContinuousConditionalMean(testCase.qm,testCase.kA,testCase.kF,testCase.tres,t1(i),1,testCase.dcpoptions);
            end
            result=[0.0039866454431516,0.0039852089081834,0.0039828953065249,0.0039791601687785,0.0039731346661603,0.0039634893442287,0.0039482395833589,0.0039245949800690,0.0038890219667012,0.0038378572262948,0.0037688359524893,0.0036833601429055,0.0035880491546997,0.0034934394894307,0.0034097676471891,0.0033429944922037,0.0032939391059319,0.0032600433618204,0.0032375971527728,0.0032231420015124,0.0032139924888825,0.0032082566920239,0.0032046743325301,0.0032024333692697,0.0032010209438178,0.0032001170358324,0.0031995233867210,0.0031991176769842,0.0031988245936350,0.0031985977861764,0.0031984086964715,0.0031982396749119,0.0031980797497219,0.0031979220311990,0.0031977621207156,0.0031975971361841,0.0031974251153692,0.0031972446506585,0.0031970546655802,0.0031968542781248,0.0031966427172440,0.0031964192719489,0.0031961832604259,0.0031959340114803,0.0031956708536113,0.0031953931088568,0.0031951000896644,0.0031947910977353,0.0031944654242050,0.0031941223507808,0.0031937611516144,0.0031933810957820,0.0031929814503010,0.0031925614836460,0.0031921204697471,0.0031916576924616,0.0031911724505133,0.0031906640628940,0.0031901318747176,0.0031895752635092,0.0031889936459059,0.0031883864847356,0.0031877532964277,0.0031870936587010,0.0031864072184566,0.0031856936997961,0.0031849529120671,0.0031841847578277,0.0031833892406085,0.0031825664723394,0.0031817166802987,0.0031808402134354,0.0031799375479120,0.0031790092917105,0.0031780561881542,0.0031770791181965,0.0031760791013487,0.0031750572951278,0.0031740149929326,0.0031729536202773,0.0031718747293471,0.0031707799918671,0.0031696711903177,0.0031685502075633,0.0031674190149979,0.0031662796593519,0.0031651342483333,0.0031639849353098,0.0031628339032649,0.0031616833482767,0.0031605354627864,0.0031593924189251,0.0031582563521682,0.0031571293455762,0.0031560134148670,0.0031549104945392,0.0031538224252404,0.0031527509425421,0.0031516976672461,0.0031506640973119,0.0031496516014568,0.0031486614144421,0.0031476946340270,0.0031467522195372,0.0031458349919678,0.0031449436355177,0.0031440787004310,0.0031432406070074,0.0031424296506345,0.0031416460076872,0.0031408897421416,0.0031401608127496,0.0031394590806276,0.0031387843171229,0.0031381362118274,0.0031375143806241,0.0031369183736625,0.0031363476831729,0.0031358017510423,0.0031352799760897,0.0031347817209888,0.0031343063187990,0.0031338530790771,0.0031334212935511,0.0031330102413454,0.0031326191937578,0.0031322474185896,0.0031318941840416,0.0031315587621887,0.0031312404320512,0.0031309384822839,0.0031306522135051,0.0031303809402893,0.0031301239928479,0.0031298807184225,0.0031296504824160,0.0031294326692841,0.0031292266832116,0.0031290319485948,0.0031288479103514,0.0031286740340778,0.0031285098060721,0.0031283547332399,0.0031282083428987,0.0031280701824961,0.0031279398192540,0.0031278168397517,0.0031277008494579,0.0031275914722223,0.0031274883497345,0.0031273911409588,0.0031272995215506,0.0031272131832620,0.0031271318333394,0.0031270551939210,0.0031269830014341,0.0031269150059993,0.0031268509708413,0.0031267906717112,0.0031267338963201,0.0031266804437874,0.0031266301241036,0.0031265827576099,0.0031265381744935,0.0031264962143019,0.0031264567254734,0.0031264195648864,0.0031263845974262,0.0031263516955698,0.0031263207389886,0.0031262916141678,0.0031262642140434,0.0031262384376561,0.0031262141898204,0.0031261913808107,0.0031261699260620,0.0031261497458852,0.0031261307651973,0.0031261129132642,0.0031260961234583,0.0031260803330268,0.0031260654828735,0.0031260515173518,0.0031260383840681,0.0031260260336967,0.0031260144198042,0.0031260034986833,0.0031259932291961,0.0031259835726262,0.0031259744925382,0.0031259659546456,0.0031259579266864,0.0031259503783050,0.0031259432809411,0.0031259366077249,0.0031259303333784,0.0031259244341217,0.0031259188875859,0.0031259136727295,0.0031259087697607,0.0031259041600639,0.0031258998261300,0.0031258957514917,0.0031258919206613,0.0031258883190735,0.0031258849330302,0.0031258817496497,0.0031258787568179,0.0031258759431431,0.0031258732979128,0.0031258708110540,0.0031258684730943,0.0031258662751272,0.0031258642087777,0.0031258622661709,0.0031258604399025,0.0031258587230104,0.0031258571089486,0.0031258555915624,0.0031258541650648,0.0031258528240150,0.0031258515632974,0.0031258503781025,0.0031258492639082,0.0031258482164631,0.0031258472317701,0.0031258463060713,0.0031258454358335,0.0031258446177352,0.0031258438486535,0.0031258431256525,0.0031258424459721,0.0031258418070171,0.0031258412063482,0.0031258406416717,0.0031258401108315,0.0031258396118004,0.0031258391426729,0.0031258387016573,0.0031258382870693,0.0031258378973256,0.0031258375309377,0.0031258371865060,0.0031258368627150,0.0031258365583280,0.0031258362721822,0.0031258360031847,0.0031258357503079,0.0031258355125857,0.0031258352891102,0.0031258350790275,0.0031258348815350,0.0031258346958785,0.0031258345213484,0.0031258343572781,0.0031258342030408,0.0031258340580472,0.0031258339217433,0.0031258337936083,0.0031258336731528,0.0031258335599164,0.0031258334534666,0.0031258333533966,0.0031258332593241,0.0031258331708897,0.0031258330877554,0.0031258330096036,0.0031258329361357,0.0031258328670710,0.0031258328021456,0.0031258327411115,0.0031258326837353,0.0031258326297979,0.0031258325790932,0.0031258325314275,0.0031258324866185,0.0031258324444952,0.0031258324048965,0.0031258323676711,0.0031258323326767,0.0031258322997798,0.0031258322688545,0.0031258322397827,0.0031258322124533,0.0031258321867619,0.0031258321626103,0.0031258321399062,0.0031258321185629,0.0031258320984988,0.0031258320796372,0.0031258320619061,0.0031258320452377,0.0031258320295684,0.0031258320148381,0.0031258320009908,0.0031258319879733,0.0031258319757361,0.0031258319642323,0.0031258319534180,0.0031258319432518,0.0031258319336950,0.0031258319247109,0.0031258319162653,0.0031258319083259,0.0031258319008624,0.0031258318938461,0.0031258318872504,0.0031258318810500,0.0031258318752213,0.0031258318697418,0.0031258318645908,0.0031258318597485,0.0031258318551965,0.0031258318509172,0.0031258318468945,0.0031258318431128,0.0031258318395578,0.0031258318362159,0.0031258318330743,0.0031258318301209,0.0031258318273446,0.0031258318247347,0.0031258318222812,0.0031258318199747,0.0031258318178065,0.0031258318157683,0.0031258318138522,0.0031258318120509,0.0031258318103576,0.0031258318087658,0.0031258318072694,0.0031258318058627,0.0031258318045403,0.0031258318032972,0.0031258318021285,0.0031258318010299,0.0031258317999972,0.0031258317990263,0.0031258317981137,0.0031258317972557,0.0031258317964492,0.0031258317956910,0.0031258317949782,0.0031258317943082,0.0031258317936783,0.0031258317930862,0.0031258317925295,0.0031258317920063,0.0031258317915143,0.0031258317910519,0.0031258317906172,0.0031258317902085,0.0031258317898244,0.0031258317894632,0.0031258317891237,0.0031258317888046,0.0031258317885046,0.0031258317882225,0.0031258317879574,0.0031258317877082,0.0031258317874739,0.0031258317872536,0.0031258317870465,0.0031258317868519,0.0031258317866689,0.0031258317864969,0.0031258317863352,0.0031258317861832,0.0031258317860403,0.0031258317859059,0.0031258317857796,0.0031258317856609,0.0031258317855493,0.0031258317854444,0.0031258317853458,0.0031258317852531,0.0031258317851659,0.0031258317850840,0.0031258317850070,0.0031258317849346,0.0031258317848665,0.0031258317848025,0.0031258317847423,0.0031258317846858,0.0031258317846326,0.0031258317845827,0.0031258317845357,0.0031258317844915,0.0031258317844500,0.0031258317844110,0.0031258317843743,0.0031258317843398,0.0031258317843074,0.0031258317842769,0.0031258317842483,0.0031258317842213,0.0031258317841960,0.0031258317841722,0.0031258317841498,0.0031258317841288,0.0031258317841090,0.0031258317840904,0.0031258317840730,0.0031258317840565,0.0031258317840411,0.0031258317840266,0.0031258317840129,0.0031258317840001,0.0031258317839880,0.0031258317839767,0.0031258317839660,0.0031258317839560,0.0031258317839466,0.0031258317839378,0.0031258317839294,0.0031258317839216,0.0031258317839142,0.0031258317839073,0.0031258317839008,0.0031258317838947,0.0031258317838890,0.0031258317838836,0.0031258317838785,0.0031258317838737,0.0031258317838692,0.0031258317838650,0.0031258317838611,0.0031258317838573,0.0031258317838538,0.0031258317838505,0.0031258317838474,0.0031258317838445,0.0031258317838418,0.0031258317838392,0.0031258317838368,0.0031258317838345,0.0031258317838324,0.0031258317838304,0.0031258317838285,0.0031258317838267,0.0031258317838251,0.0031258317838235,0.0031258317838220,0.0031258317838206,0.0031258317838193,0.0031258317838181,0.0031258317838169,0.0031258317838159,0.0031258317838148,0.0031258317838139,0.0031258317838130,0.0031258317838121,0.0031258317838113,0.0031258317838106,0.0031258317838099,0.0031258317838092,0.0031258317838086,0.0031258317838080,0.0031258317838075,0.0031258317838070,0.0031258317838065,0.0031258317838060,0.0031258317838056,0.0031258317838052,0.0031258317838048,0.0031258317838045,0.0031258317838041,0.0031258317838038,0.0031258317838035,0.0031258317838032,0.0031258317838030,0.0031258317838027,0.0031258317838025,0.0031258317838023,0.0031258317838021,0.0031258317838019,0.0031258317838017,0.0031258317838015,0.0031258317838014,0.0031258317838012,0.0031258317838011,0.0031258317838010,0.0031258317838008,0.0031258317838007,0.0031258317838006,0.0031258317838005,0.0031258317838004,0.0031258317838003,0.0031258317838002,0.0031258317838001,0.0031258317838001,0.0031258317838000,0.0031258317837999,0.0031258317837999,0.0031258317837998,0.0031258317837998,0.0031258317837997,0.0031258317837997,0.0031258317837996,0.0031258317837996,0.0031258317837995,0.0031258317837995,0.0031258317837994,0.0031258317837994,0.0031258317837994,0.0031258317837994,0.0031258317837993,0.0031258317837993,0.0031258317837993,0.0031258317837992,0.0031258317837992,0.0031258317837992,0.0031258317837992,0.0031258317837992,0.0031258317837992,0.0031258317837991,0.0031258317837991,0.0031258317837991,0.0031258317837991,0.0031258317837991,0.0031258317837991,0.0031258317837991,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837990,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989,0.0031258317837989];
            testCase.verifyEqual(continuous_conditional_mean,result,'AbsTol', 1e-10);
            
        end
        
        function testHistogram(testCase)
            %unconditional open
            [open, shut] = RecordingManipulator.getPeriods(testCase.resolvedIntervals);
            
            [buckets,frequency,dx] =  Histogram(open.intervals,testCase.tres);
            testCase.verifyEqual(buckets',[0.0000500000000000,0.0000500000000000,0.0000605763829314,0.0000605763829314,0.0000733899633811,0.0000733899633811,0.0000889139705019,0.0000889139705019,0.0001077217345016,0.0001077217345016,0.0001305078607841,0.0001305078607841,0.0001581138830084,0.0001581138830084,0.0001915593424779,0.0001915593424779,0.0002320794416806,0.0002320794416806,0.0002811706625952,0.0002811706625952,0.0003406460345290,0.0003406460345290,0.0004127020926340,0.0004127020926340,0.0005000000000000,0.0005000000000000,0.0006057638293143,0.0006057638293143,0.0007338996338110,0.0007338996338110,0.0008891397050195,0.0008891397050195,0.0010772173450159,0.0010772173450159,0.0013050786078413,0.0013050786078413,0.0015811388300842,0.0015811388300842,0.0019155934247786,0.0019155934247786,0.0023207944168064,0.0023207944168064,0.0028117066259517,0.0028117066259517,0.0034064603452898,0.0034064603452898,0.0041270209263401,0.0041270209263401,0.0050000000000000,0.0050000000000000,0.0060576382931429,0.0060576382931429,0.0073389963381103,0.0073389963381103,0.0088913970501946,0.0088913970501946,0.0107721734501594,0.0107721734501594,0.0130507860784127,0.0130507860784127,0.0158113883008419,0.0158113883008419,0.0191559342477864,0.0191559342477864,0.0232079441680638,0.0232079441680638,0.0281170662595174,0.0281170662595174,0.0340646034528980,0.0340646034528980,0.0412702092634008,0.0412702092634008,0.0499999999999999,0.0499999999999999,0.0605763829314293,0.0605763829314293,0.0733899633811033,0.0733899633811033,0.0889139705019459,0.0889139705019459,0.1077217345015939,0.1077217345015939,0.1305078607841264,0.1305078607841264,0.1581138830084185,0.1581138830084185,0.1915593424778638,0.1915593424778638,0.2320794416806382,0.2320794416806382,0.2811706625951736,0.2811706625951736,0.3406460345289795,0.3406460345289795,0.4127020926340078,0.4127020926340078,0.4999999999999982,0.4999999999999982,0.6057638293142920,0.6057638293142920,0.7338996338110321,0.7338996338110321,0.8891397050194580,0.8891397050194580],'AbsTol', 1e-10);
            testCase.verifyEqual(frequency',[0.0000000000000000,122.0000000000000000,122.0000000000000000,155.0000000000000000,155.0000000000000000,157.0000000000000000,157.0000000000000000,223.0000000000000000,223.0000000000000000,236.0000000000000000,236.0000000000000000,288.0000000000000000,288.0000000000000000,335.0000000000000000,335.0000000000000000,398.0000000000000000,398.0000000000000000,400.0000000000000000,400.0000000000000000,465.0000000000000000,465.0000000000000000,517.0000000000000000,517.0000000000000000,551.0000000000000000,551.0000000000000000,606.0000000000000000,606.0000000000000000,647.0000000000000000,647.0000000000000000,738.0000000000000000,738.0000000000000000,868.0000000000000000,868.0000000000000000,913.0000000000000000,913.0000000000000000,965.0000000000000000,965.0000000000000000,1108.0000000000000000,1108.0000000000000000,1159.0000000000000000,1159.0000000000000000,1311.0000000000000000,1311.0000000000000000,1348.0000000000000000,1348.0000000000000000,1374.0000000000000000,1374.0000000000000000,1312.0000000000000000,1312.0000000000000000,1233.0000000000000000,1233.0000000000000000,1107.0000000000000000,1107.0000000000000000,897.0000000000000000,897.0000000000000000,745.0000000000000000,745.0000000000000000,534.0000000000000000,534.0000000000000000,344.0000000000000000,344.0000000000000000,174.0000000000000000,174.0000000000000000,79.0000000000000000,79.0000000000000000,37.0000000000000000,37.0000000000000000,9.0000000000000000,9.0000000000000000,2.0000000000000000,2.0000000000000000,2.0000000000000000,2.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000],'AbsTol', 1e-10);
            testCase.verifyEqual(dx,1.2115276586285884,'AbsTol', 1e-10);
            
            %unclonditional shut
            [buckets,frequency,dx] =  Histogram(shut.intervals,testCase.tres);
            testCase.verifyEqual(buckets',[0.0000500000000000,0.0000500000000000,0.0000605763829314,0.0000605763829314,0.0000733899633811,0.0000733899633811,0.0000889139705019,0.0000889139705019,0.0001077217345016,0.0001077217345016,0.0001305078607841,0.0001305078607841,0.0001581138830084,0.0001581138830084,0.0001915593424779,0.0001915593424779,0.0002320794416806,0.0002320794416806,0.0002811706625952,0.0002811706625952,0.0003406460345290,0.0003406460345290,0.0004127020926340,0.0004127020926340,0.0005000000000000,0.0005000000000000,0.0006057638293143,0.0006057638293143,0.0007338996338110,0.0007338996338110,0.0008891397050195,0.0008891397050195,0.0010772173450159,0.0010772173450159,0.0013050786078413,0.0013050786078413,0.0015811388300842,0.0015811388300842,0.0019155934247786,0.0019155934247786,0.0023207944168064,0.0023207944168064,0.0028117066259517,0.0028117066259517,0.0034064603452898,0.0034064603452898,0.0041270209263401,0.0041270209263401,0.0050000000000000,0.0050000000000000,0.0060576382931429,0.0060576382931429,0.0073389963381103,0.0073389963381103,0.0088913970501946,0.0088913970501946,0.0107721734501594,0.0107721734501594,0.0130507860784127,0.0130507860784127,0.0158113883008419,0.0158113883008419,0.0191559342477864,0.0191559342477864,0.0232079441680638,0.0232079441680638,0.0281170662595174,0.0281170662595174,0.0340646034528980,0.0340646034528980,0.0412702092634008,0.0412702092634008,0.0499999999999999,0.0499999999999999,0.0605763829314293,0.0605763829314293,0.0733899633811033,0.0733899633811033,0.0889139705019459,0.0889139705019459,0.1077217345015939,0.1077217345015939,0.1305078607841264,0.1305078607841264,0.1581138830084185,0.1581138830084185,0.1915593424778638,0.1915593424778638,0.2320794416806382,0.2320794416806382,0.2811706625951736,0.2811706625951736,0.3406460345289795,0.3406460345289795,0.4127020926340078,0.4127020926340078,0.4999999999999982,0.4999999999999982,0.6057638293142920,0.6057638293142920,0.7338996338110321,0.7338996338110321,0.8891397050194580,0.8891397050194580,1.0772173450159377,1.0772173450159377,1.3050786078412633,1.3050786078412633,1.5811388300841833,1.5811388300841833,1.9155934247786361,1.9155934247786361,2.3207944168063799,2.3207944168063799,2.8117066259517336,2.8117066259517336,3.4064603452897915,3.4064603452897915,4.1270209263400748,4.1270209263400748,4.9999999999999778,4.9999999999999778,6.0576382931429142,6.0576382931429142,7.3389963381103138,7.3389963381103138,8.8913970501945716,8.8913970501945716,10.7721734501593680,10.7721734501593680,13.0507860784126208,13.0507860784126208,15.8113883008418199,15.8113883008418199,19.1559342477863446,19.1559342477863446,23.2079441680637792,23.2079441680637792,28.1170662595173120,28.1170662595173120,34.0646034528978916,34.0646034528978916,41.2702092634007016,41.2702092634007016,49.9999999999997371,49.9999999999997371],'AbsTol', 1e-10);
            testCase.verifyEqual(frequency',[0.0000000000000000,2010.0000000000000000,2010.0000000000000000,1913.0000000000000000,1913.0000000000000000,1749.0000000000000000,1749.0000000000000000,1588.0000000000000000,1588.0000000000000000,1333.0000000000000000,1333.0000000000000000,1019.0000000000000000,1019.0000000000000000,716.0000000000000000,716.0000000000000000,448.0000000000000000,448.0000000000000000,224.0000000000000000,224.0000000000000000,125.0000000000000000,125.0000000000000000,55.0000000000000000,55.0000000000000000,32.0000000000000000,32.0000000000000000,28.0000000000000000,28.0000000000000000,25.0000000000000000,25.0000000000000000,12.0000000000000000,12.0000000000000000,19.0000000000000000,19.0000000000000000,9.0000000000000000,9.0000000000000000,7.0000000000000000,7.0000000000000000,7.0000000000000000,7.0000000000000000,4.0000000000000000,4.0000000000000000,2.0000000000000000,2.0000000000000000,2.0000000000000000,2.0000000000000000,6.0000000000000000,6.0000000000000000,0.0000000000000000,0.0000000000000000,2.0000000000000000,2.0000000000000000,5.0000000000000000,5.0000000000000000,2.0000000000000000,2.0000000000000000,3.0000000000000000,3.0000000000000000,5.0000000000000000,5.0000000000000000,7.0000000000000000,7.0000000000000000,14.0000000000000000,14.0000000000000000,10.0000000000000000,10.0000000000000000,12.0000000000000000,12.0000000000000000,20.0000000000000000,20.0000000000000000,25.0000000000000000,25.0000000000000000,31.0000000000000000,31.0000000000000000,31.0000000000000000,31.0000000000000000,27.0000000000000000,27.0000000000000000,39.0000000000000000,39.0000000000000000,41.0000000000000000,41.0000000000000000,55.0000000000000000,55.0000000000000000,69.0000000000000000,69.0000000000000000,82.0000000000000000,82.0000000000000000,93.0000000000000000,93.0000000000000000,111.0000000000000000,111.0000000000000000,130.0000000000000000,130.0000000000000000,177.0000000000000000,177.0000000000000000,205.0000000000000000,205.0000000000000000,224.0000000000000000,224.0000000000000000,291.0000000000000000,291.0000000000000000,347.0000000000000000,347.0000000000000000,373.0000000000000000,373.0000000000000000,421.0000000000000000,421.0000000000000000,493.0000000000000000,493.0000000000000000,559.0000000000000000,559.0000000000000000,584.0000000000000000,584.0000000000000000,658.0000000000000000,658.0000000000000000,681.0000000000000000,681.0000000000000000,693.0000000000000000,693.0000000000000000,724.0000000000000000,724.0000000000000000,679.0000000000000000,679.0000000000000000,566.0000000000000000,566.0000000000000000,493.0000000000000000,493.0000000000000000,395.0000000000000000,395.0000000000000000,283.0000000000000000,283.0000000000000000,187.0000000000000000,187.0000000000000000,100.0000000000000000,100.0000000000000000,43.0000000000000000,43.0000000000000000,30.0000000000000000,30.0000000000000000,3.0000000000000000,3.0000000000000000,1.0000000000000000,1.0000000000000000,2.0000000000000000,2.0000000000000000,0.0000000000000000],'AbsTol', 1e-10);
            testCase.verifyEqual(dx,1.2115276586285884,'AbsTol', 1e-10);
            
            %conditional openings (next to shut intervals < 0.15 msec)
            open_intervals = RecordingManipulator.getSuceedingPeriodsWithRange(testCase.resolvedIntervals,1,[testCase.tres 0.15/1000]);
            [buckets,frequency,dx] =  Histogram(open_intervals,testCase.tres);
            testCase.verifyEqual(buckets',[0.0000500000000000,0.0000500000000000,0.0000605763829314,0.0000605763829314,0.0000733899633811,0.0000733899633811,0.0000889139705019,0.0000889139705019,0.0001077217345016,0.0001077217345016,0.0001305078607841,0.0001305078607841,0.0001581138830084,0.0001581138830084,0.0001915593424779,0.0001915593424779,0.0002320794416806,0.0002320794416806,0.0002811706625952,0.0002811706625952,0.0003406460345290,0.0003406460345290,0.0004127020926340,0.0004127020926340,0.0005000000000000,0.0005000000000000,0.0006057638293143,0.0006057638293143,0.0007338996338110,0.0007338996338110,0.0008891397050195,0.0008891397050195,0.0010772173450159,0.0010772173450159,0.0013050786078413,0.0013050786078413,0.0015811388300842,0.0015811388300842,0.0019155934247786,0.0019155934247786,0.0023207944168064,0.0023207944168064,0.0028117066259517,0.0028117066259517,0.0034064603452898,0.0034064603452898,0.0041270209263401,0.0041270209263401,0.0050000000000000,0.0050000000000000,0.0060576382931429,0.0060576382931429,0.0073389963381103,0.0073389963381103,0.0088913970501946,0.0088913970501946,0.0107721734501594,0.0107721734501594,0.0130507860784127,0.0130507860784127,0.0158113883008419,0.0158113883008419,0.0191559342477864,0.0191559342477864,0.0232079441680638,0.0232079441680638,0.0281170662595174,0.0281170662595174,0.0340646034528980,0.0340646034528980,0.0412702092634008,0.0412702092634008,0.0499999999999999,0.0499999999999999,0.0605763829314293,0.0605763829314293,0.0733899633811033,0.0733899633811033,0.0889139705019459,0.0889139705019459,0.1077217345015939,0.1077217345015939,0.1305078607841264,0.1305078607841264,0.1581138830084185,0.1581138830084185,0.1915593424778638,0.1915593424778638,0.2320794416806382,0.2320794416806382,0.2811706625951736,0.2811706625951736,0.3406460345289795,0.3406460345289795,0.4127020926340078,0.4127020926340078,0.4999999999999982,0.4999999999999982,0.6057638293142920,0.6057638293142920,0.7338996338110321,0.7338996338110321,0.8891397050194580,0.8891397050194580],'AbsTol', 1e-10);
            testCase.verifyEqual(frequency',[0.0000000000000000,24.0000000000000000,24.0000000000000000,28.0000000000000000,28.0000000000000000,33.0000000000000000,33.0000000000000000,57.0000000000000000,57.0000000000000000,55.0000000000000000,55.0000000000000000,68.0000000000000000,68.0000000000000000,86.0000000000000000,86.0000000000000000,98.0000000000000000,98.0000000000000000,105.0000000000000000,105.0000000000000000,127.0000000000000000,127.0000000000000000,142.0000000000000000,142.0000000000000000,177.0000000000000000,177.0000000000000000,218.0000000000000000,218.0000000000000000,253.0000000000000000,253.0000000000000000,318.0000000000000000,318.0000000000000000,378.0000000000000000,378.0000000000000000,409.0000000000000000,409.0000000000000000,450.0000000000000000,450.0000000000000000,537.0000000000000000,537.0000000000000000,576.0000000000000000,576.0000000000000000,651.0000000000000000,651.0000000000000000,666.0000000000000000,666.0000000000000000,671.0000000000000000,671.0000000000000000,638.0000000000000000,638.0000000000000000,638.0000000000000000,638.0000000000000000,546.0000000000000000,546.0000000000000000,437.0000000000000000,437.0000000000000000,383.0000000000000000,383.0000000000000000,264.0000000000000000,264.0000000000000000,165.0000000000000000,165.0000000000000000,89.0000000000000000,89.0000000000000000,46.0000000000000000,46.0000000000000000,21.0000000000000000,21.0000000000000000,4.0000000000000000,4.0000000000000000,2.0000000000000000,2.0000000000000000,1.0000000000000000,1.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000,0.0000000000000000],'AbsTol', 1e-10);
            testCase.verifyEqual(dx,1.2115276586285884,'AbsTol', 1e-10);            

        end
    end
    
end